; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PUBLIC\PowerVR-SDK\OVG\Shell\OS\Windows\PVRShellOS.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?g_bClosing@@3_NA| [ DATA ]		; g_bClosing
	EXPORT	|?g_hPower@@3PAXA| [ DATA ]		; g_hPower
	EXPORT	|?g_bRendering@@3_NA| [ DATA ]		; g_bRendering

  00000			 AREA	 |.bss|, NOINIT
|?g_bClosing@@3_NA| % 0x1				; g_bClosing
|?g_hPower@@3PAXA| % 0x4				; g_hPower

  00000			 AREA	 |.data|, DATA
|?g_bRendering@@3_NA| DCB 0x1				; g_bRendering
	EXPORT	|?OsInit@PVRShellInit@@QAAXXZ|		; PVRShellInit::OsInit
	IMPORT	|??3@YAXPAX@Z|				; operator delete
	IMPORT	|?SetWritePath@PVRShellInit@@QAAXQBD@Z|	; PVRShellInit::SetWritePath
	IMPORT	|?SetReadPath@PVRShellInit@@QAAXQBD@Z|	; PVRShellInit::SetReadPath
	IMPORT	|?SetAppName@PVRShellInit@@QAAXQBD@Z|	; PVRShellInit::SetAppName
	IMPORT	|GetModuleFileNameW|
	IMPORT	|??2@YAPAXI@Z|				; operator new
	IMPORT	|wcslen|
; File c:\wince600\public\powervr-sdk\ovg\shell\os\windows\pvrshellos.cpp

  00000			 AREA	 |.pdata|, PDATA
|$T33464| DCD	|$LN12@OsInit|
	DCD	0x40003d01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsInit@PVRShellInit@@QAAXXZ| PROC	; PVRShellInit::OsInit

; 112  : {

  00000		 |$LN12@OsInit|
  00000	e92d4070	 stmdb       sp!, {r4 - r6, lr}
  00004		 |$M33461|
  00004	e1a06000	 mov         r6, r0

; 113  : 
; 114  : #if defined UNDER_CE
; 115  : 	m_pShell->m_pShellData->bFullScreen = true; // WinCE overrides default to use fullscreen

  00008	e5963040	 ldr         r3, [r6, #0x40]
  0000c	e3a02001	 mov         r2, #1

; 116  : #endif
; 117  : 
; 118  : 	m_hAccelTable = 0;

  00010	e3a04000	 mov         r4, #0
  00014	e5933004	 ldr         r3, [r3, #4]

; 119  : 
; 120  : 	m_pShell->m_pShellData->nShellDimX = SHELL_DISPLAY_DIM_X;

  00018	e3a010f0	 mov         r1, #0xF0

; 121  : 	m_pShell->m_pShellData->nShellDimY = SHELL_DISPLAY_DIM_Y;

  0001c	e3a0ed05	 mov         lr, #5, 26
  00020	e5c32018	 strb        r2, [r3, #0x18]
  00024	e5963040	 ldr         r3, [r6, #0x40]
  00028	e5864030	 str         r4, [r6, #0x30]

; 122  : 
; 123  : 	m_hDC = 0;
; 124  : 	m_hWnd = 0;
; 125  : 
; 126  : 	// Pixmap support: init variables to 0
; 127  : 	m_hBmPixmap = 0;
; 128  : 	m_hBmPixmapOld = 0;
; 129  : 	m_hDcPixmap = 0;
; 130  : 
; 131  : 	/*
; 132  : 		Construct the binary path for GetReadPath() and GetWritePath()
; 133  : 	*/
; 134  : 	{
; 135  : 		/* Allocate memory for strings and return 0 if allocation failed */
; 136  : 		TCHAR* exeNameTCHAR = new TCHAR[DIR_BUFFER_LEN];

  0002c	e3a00a05	 mov         r0, #5, 20
  00030	e5933004	 ldr         r3, [r3, #4]
  00034	e5831008	 str         r1, [r3, #8]
  00038	e5963040	 ldr         r3, [r6, #0x40]
  0003c	e5933004	 ldr         r3, [r3, #4]
  00040	e583e00c	 str         lr, [r3, #0xC]
  00044	e586401c	 str         r4, [r6, #0x1C]
  00048	e5864020	 str         r4, [r6, #0x20]
  0004c	e5864024	 str         r4, [r6, #0x24]
  00050	e5864028	 str         r4, [r6, #0x28]
  00054	e586402c	 str         r4, [r6, #0x2C]
  00058	eb000000	 bl          |??2@YAPAXI@Z|
  0005c	e1a05000	 mov         r5, r0

; 137  : 		char* exeName = new char[DIR_BUFFER_LEN];

  00060	e3a00b0a	 mov         r0, #0xA, 22
  00064	eb000000	 bl          |??2@YAPAXI@Z|
  00068	e1a04000	 mov         r4, r0

; 138  : 		if(exeNameTCHAR && exeName)

  0006c	e3550000	 cmp         r5, #0
  00070	0a000019	 beq         |$LN4@OsInit|
  00074	e3540000	 cmp         r4, #0
  00078	0a000017	 beq         |$LN4@OsInit|

; 139  : 		{
; 140  : 			DWORD retSize;
; 141  : 
; 142  : 			/*
; 143  : 				Get the data path and a default application name
; 144  : 			*/
; 145  : 
; 146  : 			// Get full path of executable
; 147  : 			retSize = GetModuleFileName(NULL, exeNameTCHAR, DIR_BUFFER_LEN);

  0007c	e3a02b0a	 mov         r2, #0xA, 22
  00080	e1a01005	 mov         r1, r5
  00084	e3a00000	 mov         r0, #0
  00088	eb000000	 bl          GetModuleFileNameW

; 148  : 
; 149  : 			if (DIR_BUFFER_LEN > (int)retSize)

  0008c	e3500b0a	 cmp         r0, #0xA, 22
  00090	aa000011	 bge         |$LN4@OsInit|

; 150  : 			{
; 151  : 				/* Get string length in char */
; 152  : 				retSize = (DWORD)_tcslen(exeNameTCHAR);

  00094	e1a00005	 mov         r0, r5
  00098	eb000000	 bl          wcslen

; 153  : 
; 154  : 				/* Convert TChar to char */
; 155  : 				for (DWORD i = 0; i <= retSize; i++)

  0009c	e3a02000	 mov         r2, #0
  000a0	e1a01005	 mov         r1, r5
  000a4		 |$LL3@OsInit|

; 156  : 				{
; 157  : 					exeName[i] = (char)exeNameTCHAR[i];

  000a4	e0d130b2	 ldrh        r3, [r1], #2
  000a8	e7c23004	 strb        r3, [r2, +r4]
  000ac	e2822001	 add         r2, r2, #1
  000b0	e1520000	 cmp         r2, r0
  000b4	9afffffa	 bls         |$LL3@OsInit|

; 158  : 				}
; 159  : 
; 160  : 				SetAppName(exeName);

  000b8	e1a01004	 mov         r1, r4
  000bc	e1a00006	 mov         r0, r6
  000c0	eb000000	 bl          |?SetAppName@PVRShellInit@@QAAXQBD@Z|

; 161  : 				SetReadPath(exeName);

  000c4	e1a01004	 mov         r1, r4
  000c8	e1a00006	 mov         r0, r6
  000cc	eb000000	 bl          |?SetReadPath@PVRShellInit@@QAAXQBD@Z|

; 162  : 				SetWritePath(exeName);

  000d0	e1a01004	 mov         r1, r4
  000d4	e1a00006	 mov         r0, r6
  000d8	eb000000	 bl          |?SetWritePath@PVRShellInit@@QAAXQBD@Z|
  000dc		 |$LN4@OsInit|

; 163  : 			}
; 164  : 		}
; 165  : 
; 166  : 		delete [] exeName;

  000dc	e1a00004	 mov         r0, r4
  000e0	eb000000	 bl          |??3@YAXPAX@Z|

; 167  : 		delete [] exeNameTCHAR;

  000e4	e1a00005	 mov         r0, r5
  000e8	eb000000	 bl          |??3@YAXPAX@Z|

; 168  : 	}
; 169  : }

  000ec	e8bd4070	 ldmia       sp!, {r4 - r6, lr}
  000f0	e12fff1e	 bx          lr
  000f4		 |$M33462|

			 ENDP  ; |?OsInit@PVRShellInit@@QAAXXZ|, PVRShellInit::OsInit

	EXPORT	|?OsReleaseOS@PVRShellInit@@QAAXXZ|	; PVRShellInit::OsReleaseOS
	IMPORT	|DestroyWindow|
	IMPORT	|ReleaseDC|

  00000			 AREA	 |.pdata|, PDATA
|$T33472| DCD	|$LN5@OsReleaseO|
	DCD	0x40000901
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsReleaseOS@PVRShellInit@@QAAXXZ| PROC ; PVRShellInit::OsReleaseOS

; 361  : {

  00000		 |$LN5@OsReleaseO|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M33469|
  00004	e1a04000	 mov         r4, r0

; 362  : #ifndef NO_GDI
; 363  : 	ReleaseDC(m_hWnd, m_hDC);

  00008	e594101c	 ldr         r1, [r4, #0x1C]
  0000c	e5940020	 ldr         r0, [r4, #0x20]
  00010	eb000000	 bl          ReleaseDC

; 364  : 	DestroyWindow(m_hWnd);

  00014	e5940020	 ldr         r0, [r4, #0x20]
  00018	eb000000	 bl          DestroyWindow

; 365  : #endif
; 366  : }

  0001c	e8bd4010	 ldmia       sp!, {r4, lr}
  00020	e12fff1e	 bx          lr
  00024		 |$M33470|

			 ENDP  ; |?OsReleaseOS@PVRShellInit@@QAAXXZ|, PVRShellInit::OsReleaseOS

	EXPORT	|?OsExit@PVRShellInit@@QAAXXZ|		; PVRShellInit::OsExit
	IMPORT	|free|
	IMPORT	|MessageBoxW|
	IMPORT	|malloc|
	IMPORT	|?PVRShellGet@PVRShell@@QBAPBXW4prefNameConstPtrEnum@@@Z| ; PVRShell::PVRShellGet
	IMPORT	|strlen|

  00000			 AREA	 |.pdata|, PDATA
|$T33489| DCD	|$LN19@OsExit|
	DCD	0x40003e01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsExit@PVRShellInit@@QAAXXZ| PROC	; PVRShellInit::OsExit

; 373  : {

  00000		 |$LN19@OsExit|
  00000	e92d40f0	 stmdb       sp!, {r4 - r7, lr}
  00004		 |$M33486|
  00004	e1a04000	 mov         r4, r0

; 374  : 	const char	*szText;
; 375  : 
; 376  : 	/*
; 377  : 		Show the exit message to the user
; 378  : 	*/
; 379  : 	szText		= (const char*)m_pShell->PVRShellGet(prefExitMessage);

  00008	e5940040	 ldr         r0, [r4, #0x40]
  0000c	e3a01005	 mov         r1, #5
  00010	eb000000	 bl          |?PVRShellGet@PVRShell@@QBAPBXW4prefNameConstPtrEnum@@@Z|
  00014	e1a06000	 mov         r6, r0

; 380  : 
; 381  : #ifndef NO_GDI
; 382  : 	int			i, nT, nC;
; 383  : 	const char	*szCaption;
; 384  : 	TCHAR		*tzText, *tzCaption;
; 385  : 
; 386  : 	szCaption	= (const char*)m_pShell->PVRShellGet(prefAppName);

  00018	e5940040	 ldr         r0, [r4, #0x40]
  0001c	e3a01000	 mov         r1, #0
  00020	eb000000	 bl          |?PVRShellGet@PVRShell@@QBAPBXW4prefNameConstPtrEnum@@@Z|
  00024	e1a05000	 mov         r5, r0

; 387  : 
; 388  : 	if(!szText || !szCaption)

  00028	e3560000	 cmp         r6, #0
  0002c	0a00002f	 beq         |$LN9@OsExit|
  00030	e3550000	 cmp         r5, #0
  00034	0a00002d	 beq         |$LN9@OsExit|

; 389  : 		return;
; 390  : 
; 391  : 	nT = (int)strlen(szText) + 1;

  00038	e1a00006	 mov         r0, r6
  0003c	eb000000	 bl          strlen
  00040	e1a04000	 mov         r4, r0

; 392  : 	nC = (int)strlen(szCaption) + 1;

  00044	e1a00005	 mov         r0, r5
  00048	eb000000	 bl          strlen

; 393  : 
; 394  : 	tzText = (TCHAR*)malloc(nT * sizeof(*tzText));

  0004c	e2843001	 add         r3, r4, #1
  00050	e1a04000	 mov         r4, r0
  00054	e1a00083	 mov         r0, r3, lsl #1
  00058	eb000000	 bl          malloc

; 395  : 	tzCaption = (TCHAR*)malloc(nC * sizeof(*tzCaption));

  0005c	e2843001	 add         r3, r4, #1
  00060	e1a07000	 mov         r7, r0
  00064	e1a00083	 mov         r0, r3, lsl #1
  00068	eb000000	 bl          malloc

; 396  : 
; 397  : 	for(i = 0; tzText[i] = szText[i]; ++i);

  0006c	e1d630d0	 ldrsb       r3, [r6]
  00070	e1a04000	 mov         r4, r0
  00074	e1a03803	 mov         r3, r3, lsl #16
  00078	e1b03823	 movs        r3, r3, lsr #16
  0007c	e1c730b0	 strh        r3, [r7]
  00080	0a000005	 beq         |$LN6@OsExit|
  00084	e1a02007	 mov         r2, r7
  00088		 |$LL8@OsExit|
  00088	e1f630d1	 ldrsb       r3, [r6, #1]!
  0008c	e1a03803	 mov         r3, r3, lsl #16
  00090	e1b03823	 movs        r3, r3, lsr #16
  00094	e1e230b2	 strh        r3, [r2, #2]!
  00098	1afffffa	 bne         |$LL8@OsExit|
  0009c		 |$LN6@OsExit|

; 398  : 	for(i = 0; tzCaption[i] = szCaption[i]; ++i);

  0009c	e1d530d0	 ldrsb       r3, [r5]
  000a0	e1a03803	 mov         r3, r3, lsl #16
  000a4	e1b03823	 movs        r3, r3, lsr #16
  000a8	e1c430b0	 strh        r3, [r4]
  000ac	0a000005	 beq         |$LN3@OsExit|
  000b0	e1a02004	 mov         r2, r4
  000b4		 |$LL5@OsExit|
  000b4	e1f530d1	 ldrsb       r3, [r5, #1]!
  000b8	e1a03803	 mov         r3, r3, lsl #16
  000bc	e1b03823	 movs        r3, r3, lsr #16
  000c0	e1e230b2	 strh        r3, [r2, #2]!
  000c4	1afffffa	 bne         |$LL5@OsExit|
  000c8		 |$LN3@OsExit|
  000c8	e3a03801	 mov         r3, #1, 16

; 399  : 
; 400  : 	MessageBox(NULL, tzText, tzCaption, MB_OK | MB_ICONINFORMATION | MB_SETFOREGROUND);

  000cc	e3833040	 orr         r3, r3, #0x40
  000d0	e1a02004	 mov         r2, r4
  000d4	e1a01007	 mov         r1, r7
  000d8	e3a00000	 mov         r0, #0
  000dc	eb000000	 bl          MessageBoxW

; 401  : 
; 402  : 	FREE(tzText);

  000e0	e1a00007	 mov         r0, r7
  000e4	eb000000	 bl          free

; 403  : 	FREE(tzCaption);

  000e8	e1a00004	 mov         r0, r4
  000ec	eb000000	 bl          free
  000f0		 |$LN9@OsExit|

; 404  : #else
; 405  : 	OsDisplayDebugString(szText);
; 406  : #endif
; 407  : 
; 408  : }

  000f0	e8bd40f0	 ldmia       sp!, {r4 - r7, lr}
  000f4	e12fff1e	 bx          lr
  000f8		 |$M33487|

			 ENDP  ; |?OsExit@PVRShellInit@@QAAXXZ|, PVRShellInit::OsExit

	EXPORT	|?OsDoInitAPI@PVRShellInit@@QAA_NXZ|	; PVRShellInit::OsDoInitAPI
	IMPORT	|SetForegroundWindow|
	IMPORT	|SelectObject|
	IMPORT	|?ApiInitAPI@PVRShellInit@@QAA_NXZ|	; PVRShellInit::ApiInitAPI
	IMPORT	|CreateCompatibleBitmap|
	IMPORT	|CreateCompatibleDC|

  00000			 AREA	 |.pdata|, PDATA
|$T33499| DCD	|$LN8@OsDoInitAP|
	DCD	0x40002401
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsDoInitAPI@PVRShellInit@@QAA_NXZ| PROC ; PVRShellInit::OsDoInitAPI

; 416  : {

  00000		 |$LN8@OsDoInitAP|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M33496|
  00004	e1a04000	 mov         r4, r0

; 417  : #ifndef NO_GDI
; 418  : 	// Pixmap support: create the pixmap
; 419  : 	if(m_pShell->m_pShellData->bNeedPixmap)

  00008	e5943040	 ldr         r3, [r4, #0x40]
  0000c	e5933004	 ldr         r3, [r3, #4]
  00010	e5d3301c	 ldrb        r3, [r3, #0x1C]
  00014	e3530000	 cmp         r3, #0
  00018	0a000008	 beq         |$LN3@OsDoInitAP|

; 420  : 	{
; 421  : 		m_hDcPixmap = CreateCompatibleDC(m_hDC);

  0001c	e594001c	 ldr         r0, [r4, #0x1C]
  00020	eb000000	 bl          CreateCompatibleDC
  00024	e1a03000	 mov         r3, r0

; 422  : 		m_hBmPixmap = CreateCompatibleBitmap(m_hDC, 640, 480);

  00028	e594001c	 ldr         r0, [r4, #0x1C]
  0002c	e3a02e1e	 mov         r2, #0x1E, 28
  00030	e3a01d0a	 mov         r1, #0xA, 26
  00034	e584302c	 str         r3, [r4, #0x2C]
  00038	eb000000	 bl          CreateCompatibleBitmap
  0003c	e5840024	 str         r0, [r4, #0x24]
  00040		 |$LN3@OsDoInitAP|

; 423  : 	}
; 424  : #endif
; 425  : 	if(!ApiInitAPI())

  00040	e1a00004	 mov         r0, r4
  00044	eb000000	 bl          |?ApiInitAPI@PVRShellInit@@QAA_NXZ|
  00048	e3500000	 cmp         r0, #0

; 426  : 	{
; 427  : 		return false;

  0004c	03a00000	 moveq       r0, #0

; 440  : }

  00050	08bd4010	 ldmeqia     sp!, {r4, lr}
  00054	012fff1e	 bxeq        lr

; 428  : 	}
; 429  : #ifndef NO_GDI
; 430  : 	// Pixmap support: select the pixmap into a device context (DC) ready for blitting
; 431  : 	if(m_pShell->m_pShellData->bNeedPixmap)

  00058	e5943040	 ldr         r3, [r4, #0x40]
  0005c	e5933004	 ldr         r3, [r3, #4]
  00060	e5d3301c	 ldrb        r3, [r3, #0x1C]
  00064	e3530000	 cmp         r3, #0
  00068	0a000003	 beq         |$LN1@OsDoInitAP|

; 432  : 	{
; 433  : 		m_hBmPixmapOld = (HBITMAP)SelectObject(m_hDcPixmap, m_hBmPixmap);

  0006c	e5941024	 ldr         r1, [r4, #0x24]
  00070	e594002c	 ldr         r0, [r4, #0x2C]
  00074	eb000000	 bl          SelectObject
  00078	e5840028	 str         r0, [r4, #0x28]
  0007c		 |$LN1@OsDoInitAP|

; 434  : 	}
; 435  : 
; 436  : 	SetForegroundWindow(m_hWnd);

  0007c	e5940020	 ldr         r0, [r4, #0x20]
  00080	eb000000	 bl          SetForegroundWindow

; 437  : #endif
; 438  : 	/* No problem occured */
; 439  : 	return true;

  00084	e3a00001	 mov         r0, #1

; 440  : }

  00088	e8bd4010	 ldmia       sp!, {r4, lr}
  0008c	e12fff1e	 bx          lr
  00090		 |$M33497|

			 ENDP  ; |?OsDoInitAPI@PVRShellInit@@QAA_NXZ|, PVRShellInit::OsDoInitAPI

	EXPORT	|?OsDoReleaseAPI@PVRShellInit@@QAAXXZ|	; PVRShellInit::OsDoReleaseAPI
	IMPORT	|DeleteObject|
	IMPORT	|DeleteDC|
	IMPORT	|?ApiReleaseAPI@PVRShellInit@@QAAXXZ|	; PVRShellInit::ApiReleaseAPI

  00000			 AREA	 |.pdata|, PDATA
|$T33507| DCD	|$LN6@OsDoReleas|
	DCD	0x40001101
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsDoReleaseAPI@PVRShellInit@@QAAXXZ| PROC ; PVRShellInit::OsDoReleaseAPI

; 447  : {

  00000		 |$LN6@OsDoReleas|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M33504|
  00004	e1a04000	 mov         r4, r0

; 448  : #ifndef NO_GDI
; 449  : #endif
; 450  : 	ApiReleaseAPI();

  00008	eb000000	 bl          |?ApiReleaseAPI@PVRShellInit@@QAAXXZ|

; 451  : #ifndef NO_GDI
; 452  : 	if(m_pShell->m_pShellData->bNeedPixmap)

  0000c	e5943040	 ldr         r3, [r4, #0x40]
  00010	e5933004	 ldr         r3, [r3, #4]
  00014	e5d3301c	 ldrb        r3, [r3, #0x1C]
  00018	e3530000	 cmp         r3, #0
  0001c	0a000006	 beq         |$LN1@OsDoReleas|

; 453  : 	{
; 454  : 		// Pixmap support: free the pixmap
; 455  : 		SelectObject(m_hDcPixmap, m_hBmPixmapOld);

  00020	e5941028	 ldr         r1, [r4, #0x28]
  00024	e594002c	 ldr         r0, [r4, #0x2C]
  00028	eb000000	 bl          SelectObject

; 456  : 		DeleteDC(m_hDcPixmap);

  0002c	e594002c	 ldr         r0, [r4, #0x2C]
  00030	eb000000	 bl          DeleteDC

; 457  : 		DeleteObject(m_hBmPixmap);

  00034	e5940024	 ldr         r0, [r4, #0x24]
  00038	eb000000	 bl          DeleteObject
  0003c		 |$LN1@OsDoReleas|

; 458  : 	}
; 459  : 
; 460  : #endif
; 461  : }

  0003c	e8bd4010	 ldmia       sp!, {r4, lr}
  00040	e12fff1e	 bx          lr
  00044		 |$M33505|

			 ENDP  ; |?OsDoReleaseAPI@PVRShellInit@@QAAXXZ|, PVRShellInit::OsDoReleaseAPI

	EXPORT	|?OsRenderComplete@PVRShellInit@@QAAXXZ| ; PVRShellInit::OsRenderComplete
	IMPORT	|DispatchMessageW|
	IMPORT	|TranslateMessage|
	IMPORT	|TranslateAcceleratorW|
	IMPORT	|PeekMessageW|
	IMPORT	|GetMessageW|

  00000			 AREA	 |.pdata|, PDATA
|$T33521| DCD	|$LN14@OsRenderCo|
	DCD	0x40002c02
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsRenderComplete@PVRShellInit@@QAAXXZ| PROC ; PVRShellInit::OsRenderComplete

; 470  : {

  00000		 |$LN14@OsRenderCo|
  00000	e92d40f0	 stmdb       sp!, {r4 - r7, lr}
  00004	e24dd020	 sub         sp, sp, #0x20
  00008		 |$M33518|
  00008	e1a04000	 mov         r4, r0
  0000c	e59f5098	 ldr         r5, [pc, #0x98]
  00010	e3a06902	 mov         r6, #2, 18
  00014	e3a07001	 mov         r7, #1
  00018		 |$LL3@OsRenderCo|

; 471  : 	MSG		msg;
; 472  : 
; 473  : #ifdef WIN32_PLATFORM_WFSP
; 474  : 	{
; 475  : 		unsigned long nTime = m_pShell->PVRShellGetTime();
; 476  : 
; 477  : 		if((nTime - m_nTimeIdleTimeReset) > 8000)
; 478  : 		{
; 479  : 			/*
; 480  : 				Prevent Smartphone timing-out the app and returning to the
; 481  : 				menu.
; 482  : 
; 483  : 				Performance is reduced if this is called every frame, so here
; 484  : 				it is called every 8 seconds; 10 seconds is the minimum value
; 485  : 				that the user can set in "Settings/Home Screen/Time out" on
; 486  : 				Windows Smartphone.
; 487  : 			*/
; 488  : 			SHIdleTimerReset();
; 489  : 			m_nTimeIdleTimeReset = nTime;
; 490  : 		}
; 491  : 
; 492  : 		if(!m_bHaveFocus)
; 493  : 		{
; 494  : 			m_pShell->PVRShellOutputDebug("Window lost focus, quitting.\n");
; 495  : 			gShellDone = true;
; 496  : 		}
; 497  : 	}
; 498  : #endif
; 499  : 
; 500  : 	/*
; 501  : 		Process the message queue
; 502  : 	*/
; 503  : #ifdef UNDER_CE
; 504  : 	/*
; 505  : 		If the screen is off and we aren't rendering then keep going round the message loop
; 506  : 		waiting for the WM_APP_RENDER message.
; 507  : 	*/
; 508  : 	while((g_bRendering || m_pShell->m_pShellInit->gShellDone) ?
; 509  : 		PeekMessage(&msg, m_hWnd, 0, 0, PM_REMOVE): GetMessage(&msg, m_hWnd, WM_APP_RENDER, WM_APP_RENDER) > 0)

  00018	e5d53000	 ldrb        r3, [r5]
  0001c	e3530000	 cmp         r3, #0
  00020	1a00000e	 bne         |$LN6@OsRenderCo|
  00024	e5943040	 ldr         r3, [r4, #0x40]
  00028	e5933008	 ldr         r3, [r3, #8]
  0002c	e5d33058	 ldrb        r3, [r3, #0x58]
  00030	e3530000	 cmp         r3, #0
  00034	1a000009	 bne         |$LN6@OsRenderCo|
  00038	e5941020	 ldr         r1, [r4, #0x20]
  0003c	e3863002	 orr         r3, r6, #2
  00040	e3862002	 orr         r2, r6, #2
  00044	e28d0004	 add         r0, sp, #4
  00048	eb000000	 bl          GetMessageW
  0004c	e3500000	 cmp         r0, #0
  00050	ca00000a	 bgt         |$LN11@OsRenderCo|
  00054		 |$LN7@OsRenderCo|

; 520  : 
; 521  : }

  00054	e28dd020	 add         sp, sp, #0x20
  00058	e8bd40f0	 ldmia       sp!, {r4 - r7, lr}
  0005c	e12fff1e	 bx          lr
  00060		 |$LN6@OsRenderCo|

; 471  : 	MSG		msg;
; 472  : 
; 473  : #ifdef WIN32_PLATFORM_WFSP
; 474  : 	{
; 475  : 		unsigned long nTime = m_pShell->PVRShellGetTime();
; 476  : 
; 477  : 		if((nTime - m_nTimeIdleTimeReset) > 8000)
; 478  : 		{
; 479  : 			/*
; 480  : 				Prevent Smartphone timing-out the app and returning to the
; 481  : 				menu.
; 482  : 
; 483  : 				Performance is reduced if this is called every frame, so here
; 484  : 				it is called every 8 seconds; 10 seconds is the minimum value
; 485  : 				that the user can set in "Settings/Home Screen/Time out" on
; 486  : 				Windows Smartphone.
; 487  : 			*/
; 488  : 			SHIdleTimerReset();
; 489  : 			m_nTimeIdleTimeReset = nTime;
; 490  : 		}
; 491  : 
; 492  : 		if(!m_bHaveFocus)
; 493  : 		{
; 494  : 			m_pShell->PVRShellOutputDebug("Window lost focus, quitting.\n");
; 495  : 			gShellDone = true;
; 496  : 		}
; 497  : 	}
; 498  : #endif
; 499  : 
; 500  : 	/*
; 501  : 		Process the message queue
; 502  : 	*/
; 503  : #ifdef UNDER_CE
; 504  : 	/*
; 505  : 		If the screen is off and we aren't rendering then keep going round the message loop
; 506  : 		waiting for the WM_APP_RENDER message.
; 507  : 	*/
; 508  : 	while((g_bRendering || m_pShell->m_pShellInit->gShellDone) ?
; 509  : 		PeekMessage(&msg, m_hWnd, 0, 0, PM_REMOVE): GetMessage(&msg, m_hWnd, WM_APP_RENDER, WM_APP_RENDER) > 0)

  00060	e5941020	 ldr         r1, [r4, #0x20]
  00064	e3a03000	 mov         r3, #0
  00068	e3a02000	 mov         r2, #0
  0006c	e28d0004	 add         r0, sp, #4
  00070	e58d7000	 str         r7, [sp]
  00074	eb000000	 bl          PeekMessageW
  00078	e3500000	 cmp         r0, #0
  0007c	0afffff4	 beq         |$LN7@OsRenderCo|
  00080		 |$LN11@OsRenderCo|

; 510  : #else
; 511  : 	while(PeekMessage(&msg, m_hWnd, 0, 0, PM_REMOVE))
; 512  : #endif
; 513  : 	{
; 514  : 		if (!TranslateAccelerator(msg.hwnd, m_hAccelTable, &msg))

  00080	e5941030	 ldr         r1, [r4, #0x30]
  00084	e59d0004	 ldr         r0, [sp, #4]
  00088	e28d2004	 add         r2, sp, #4
  0008c	eb000000	 bl          TranslateAcceleratorW
  00090	e3500000	 cmp         r0, #0
  00094	1affffdf	 bne         |$LL3@OsRenderCo|

; 515  : 		{
; 516  : 			TranslateMessage(&msg);

  00098	e28d0004	 add         r0, sp, #4
  0009c	eb000000	 bl          TranslateMessage

; 517  : 			DispatchMessage(&msg);

  000a0	e28d0004	 add         r0, sp, #4
  000a4	eb000000	 bl          DispatchMessageW

; 518  : 		}
; 519  : 	}

  000a8	eaffffda	 b           |$LL3@OsRenderCo|
  000ac		 |$LN15@OsRenderCo|
  000ac		 |$LN16@OsRenderCo|
  000ac	00000000	 DCD         |?g_bRendering@@3_NA|
  000b0		 |$M33519|

			 ENDP  ; |?OsRenderComplete@PVRShellInit@@QAAXXZ|, PVRShellInit::OsRenderComplete

	EXPORT	|?OsPixmapCopy@PVRShellInit@@QAA_NXZ|	; PVRShellInit::OsPixmapCopy
	IMPORT	|BitBlt|

  00000			 AREA	 |.pdata|, PDATA
|$T33535| DCD	|$LN7@OsPixmapCo|
	DCD	0x40001802
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsPixmapCopy@PVRShellInit@@QAA_NXZ| PROC ; PVRShellInit::OsPixmapCopy

; 533  : {

  00000		 |$LN7@OsPixmapCo|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004	e24dd014	 sub         sp, sp, #0x14
  00008		 |$M33532|

; 534  : #ifndef NO_GDI
; 535  : 	return (BitBlt(m_hDC, 0, 0, 640, 480, m_hDcPixmap, 0, 0, SRCCOPY) == TRUE);

  00008	e590202c	 ldr         r2, [r0, #0x2C]
  0000c	e3a03733	 mov         r3, #0x33, 14
  00010	e590001c	 ldr         r0, [r0, #0x1C]
  00014	e3833020	 orr         r3, r3, #0x20
  00018	e58d3010	 str         r3, [sp, #0x10]
  0001c	e58d2004	 str         r2, [sp, #4]
  00020	e3a04e1e	 mov         r4, #0x1E, 28
  00024	e3a0e000	 mov         lr, #0
  00028	e3a03d0a	 mov         r3, #0xA, 26
  0002c	e3a02000	 mov         r2, #0
  00030	e3a01000	 mov         r1, #0
  00034	e58de00c	 str         lr, [sp, #0xC]
  00038	e58de008	 str         lr, [sp, #8]
  0003c	e58d4000	 str         r4, [sp]
  00040	eb000000	 bl          BitBlt
  00044	e3500001	 cmp         r0, #1
  00048	03a03001	 moveq       r3, #1
  0004c	13a03000	 movne       r3, #0
  00050	e20300ff	 and         r0, r3, #0xFF

; 536  : #else
; 537  : 	return 0;
; 538  : #endif
; 539  : }

  00054	e28dd014	 add         sp, sp, #0x14
  00058	e8bd4010	 ldmia       sp!, {r4, lr}
  0005c	e12fff1e	 bx          lr
  00060		 |$M33533|

			 ENDP  ; |?OsPixmapCopy@PVRShellInit@@QAA_NXZ|, PVRShellInit::OsPixmapCopy

	EXPORT	|?OsGetNativeDisplayType@PVRShellInit@@QAAPAXXZ| ; PVRShellInit::OsGetNativeDisplayType

  00000			 AREA	 |.pdata|, PDATA
|$T33545| DCD	|$LN5@OsGetNativ|
	DCD	0x40000200
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsGetNativeDisplayType@PVRShellInit@@QAAPAXXZ| PROC ; PVRShellInit::OsGetNativeDisplayType

; 547  : {

  00000		 |$LN5@OsGetNativ|
  00000		 |$M33542|

; 548  : 	return m_hDC; // Null when NO_GDI defined

  00000	e590001c	 ldr         r0, [r0, #0x1C]

; 549  : }

  00004	e12fff1e	 bx          lr
  00008		 |$M33543|

			 ENDP  ; |?OsGetNativeDisplayType@PVRShellInit@@QAAPAXXZ|, PVRShellInit::OsGetNativeDisplayType

	EXPORT	|?OsGetNativePixmapType@PVRShellInit@@QAAPAXXZ| ; PVRShellInit::OsGetNativePixmapType

  00000			 AREA	 |.pdata|, PDATA
|$T33555| DCD	|$LN5@OsGetNativ@2|
	DCD	0x40000200
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsGetNativePixmapType@PVRShellInit@@QAAPAXXZ| PROC ; PVRShellInit::OsGetNativePixmapType

; 557  : {

  00000		 |$LN5@OsGetNativ@2|
  00000		 |$M33552|

; 558  : 	// Pixmap support: return the pixmap
; 559  : 	return m_hBmPixmap; // Null when NO_GDI defined

  00000	e5900024	 ldr         r0, [r0, #0x24]

; 560  : }

  00004	e12fff1e	 bx          lr
  00008		 |$M33553|

			 ENDP  ; |?OsGetNativePixmapType@PVRShellInit@@QAAPAXXZ|, PVRShellInit::OsGetNativePixmapType

	EXPORT	|?OsGetNativeWindowType@PVRShellInit@@QAAPAXXZ| ; PVRShellInit::OsGetNativeWindowType

  00000			 AREA	 |.pdata|, PDATA
|$T33565| DCD	|$LN5@OsGetNativ@3|
	DCD	0x40000200
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsGetNativeWindowType@PVRShellInit@@QAAPAXXZ| PROC ; PVRShellInit::OsGetNativeWindowType

; 568  : {

  00000		 |$LN5@OsGetNativ@3|
  00000		 |$M33562|

; 569  : 	return m_hWnd;  // Null when NO_GDI defined

  00000	e5900020	 ldr         r0, [r0, #0x20]

; 570  : }

  00004	e12fff1e	 bx          lr
  00008		 |$M33563|

			 ENDP  ; |?OsGetNativeWindowType@PVRShellInit@@QAAPAXXZ|, PVRShellInit::OsGetNativeWindowType

	EXPORT	|?OsGet@PVRShellInit@@QAA_NW4prefNameIntEnum@@PAH@Z| ; PVRShellInit::OsGet

  00000			 AREA	 |.pdata|, PDATA
|$T33574| DCD	|$LN5@OsGet|
	DCD	0x40000200
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsGet@PVRShellInit@@QAA_NW4prefNameIntEnum@@PAH@Z| PROC ; PVRShellInit::OsGet

; 580  : {

  00000		 |$LN5@OsGet|
  00000		 |$M33571|

; 581  : 	return false;

  00000	e3a00000	 mov         r0, #0

; 582  : }

  00004	e12fff1e	 bx          lr
  00008		 |$M33572|

			 ENDP  ; |?OsGet@PVRShellInit@@QAA_NW4prefNameIntEnum@@PAH@Z|, PVRShellInit::OsGet

	EXPORT	|?OsGet@PVRShellInit@@QAA_NW4prefNamePtrEnum@@PAPAX@Z| ; PVRShellInit::OsGet

  00000			 AREA	 |.pdata|, PDATA
|$T33586| DCD	|$LN9@OsGet@2|
	DCD	0x40000600
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsGet@PVRShellInit@@QAA_NW4prefNamePtrEnum@@PAPAX@Z| PROC ; PVRShellInit::OsGet

; 592  : {

  00000		 |$LN9@OsGet@2|
  00000		 |$M33583|

; 593  : 	switch(prefName)

  00000	e3510003	 cmp         r1, #3

; 598  : 
; 599  : 	default:
; 600  : 		return false;

  00004	13a00000	 movne       r0, #0

; 594  : 	{
; 595  : 	case prefHINSTANCE:
; 596  : 		*pp = m_hInstance;

  00008	05903034	 ldreq       r3, [r0, #0x34]

; 597  : 		return true;

  0000c	03a00001	 moveq       r0, #1
  00010	05823000	 streq       r3, [r2]

; 601  : 	}
; 602  : }

  00014	e12fff1e	 bx          lr
  00018		 |$M33584|

			 ENDP  ; |?OsGet@PVRShellInit@@QAA_NW4prefNamePtrEnum@@PAPAX@Z|, PVRShellInit::OsGet

	EXPORT	|__$ArrayPad$| [ DATA ]
	EXPORT	|?OsDisplayDebugString@PVRShellInit@@QAAXQBD@Z| ; PVRShellInit::OsDisplayDebugString
	IMPORT	|OutputDebugStringW|
	IMPORT	|__GSHandlerCheck|
	IMPORT	|__security_cookie|
	IMPORT	|__security_check_cookie|

  00000			 AREA	 |.pdata|, PDATA
|$T33601| DCD	|$LN11@OsDisplayD|
	DCD	0xc0001d03

  00000			 AREA	 |.xdata|, DATA
|$T33597| DCD	0xfffffff8
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__GSHandlerCheck|
  00004	00000000	 DCD         |$T33597|

  00008		 |?OsDisplayDebugString@PVRShellInit@@QAAXQBD@Z| PROC ; PVRShellInit::OsDisplayDebugString

; 610  : {

  00008		 |$LN11@OsDisplayD|
  00008	e52de004	 str         lr, [sp, #-4]!
  0000c	e59fc064	 ldr         r12, [pc, #0x64]
  00010	e08dd00c	 add         sp, sp, r12
  00014		 |$M33598|
  00014	e3510000	 cmp         r1, #0
  00018	e59f3054	 ldr         r3, [pc, #0x54]
  0001c	e5933000	 ldr         r3, [r3]
  00020	e58d3800	 str         r3, [sp, #0x800]

; 611  : 	if(str)

  00024	0a00000b	 beq         |$LN5@OsDisplayD|

; 612  : 	{
; 613  : #ifdef UNICODE
; 614  : 		wchar_t	strc[1024];
; 615  : 		int		i = 0;

  00028	e3a02000	 mov         r2, #0
  0002c	e28d0000	 add         r0, sp, #0
  00030		 |$LL4@OsDisplayD|

; 616  : 
; 617  : #if 0
; 618  : 		for(i = 0; (str[i] != '\0') && (i < (sizeof(strc) / sizeof(*strc))); ++i)
; 619  : 		{
; 620  : 			strc[i] = (wchar_t)str[i];
; 621  : 		}
; 622  : #endif
; 623  : 		do{
; 624  : 			strc[i] = (wchar_t)str[i];

  00030	e19230d1	 ldrsb       r3, [r2, +r1]
  00034	e1c030b0	 strh        r3, [r0]

; 625  : 		}while ((str[i] != '\0') && (i++ < (sizeof(strc) / sizeof(*strc))));

  00038	e3530000	 cmp         r3, #0
  0003c	0a000003	 beq         |$LN1@OsDisplayD|
  00040	e3520b01	 cmp         r2, #1, 22
  00044	e2822001	 add         r2, r2, #1
  00048	e2800002	 add         r0, r0, #2
  0004c	3afffff7	 bcc         |$LL4@OsDisplayD|
  00050		 |$LN1@OsDisplayD|

; 626  : 
; 627  : 		OutputDebugString(strc);

  00050	e28d0000	 add         r0, sp, #0
  00054	eb000000	 bl          OutputDebugStringW
  00058		 |$LN5@OsDisplayD|
  00058	e59d0800	 ldr         r0, [sp, #0x800]
  0005c	eb000000	 bl          __security_check_cookie

; 628  : #else
; 629  : 		OutputDebugString(str);
; 630  : #endif
; 631  : 	}
; 632  : }

  00060	e3a0cb02	 mov         r12, #2, 22
  00064	e38cc004	 orr         r12, r12, #4
  00068	e08dd00c	 add         sp, sp, r12
  0006c	e49de004	 ldr         lr, [sp], #4
  00070	e12fff1e	 bx          lr
  00074		 |$LN12@OsDisplayD|
  00074		 |$LN13@OsDisplayD|
  00074	00000000	 DCD         |__security_cookie|
  00078		 |$LN14@OsDisplayD|
  00078	fffff7fc	 DCD         0xfffff7fc
  0007c		 |$M33599|

			 ENDP  ; |?OsDisplayDebugString@PVRShellInit@@QAAXQBD@Z|, PVRShellInit::OsDisplayDebugString

	EXPORT	|?OsGetTime@PVRShellInit@@QAAKXZ|	; PVRShellInit::OsGetTime
	IMPORT	|GetTickCount|

  00000			 AREA	 |.pdata|, PDATA
|$T33614| DCD	|$LN5@OsGetTime|
	DCD	0x40000401
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsGetTime@PVRShellInit@@QAAKXZ| PROC	; PVRShellInit::OsGetTime

; 640  : {

  00000		 |$LN5@OsGetTime|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M33611|

; 641  : 	return (unsigned long)GetTickCount();

  00004	eb000000	 bl          GetTickCount

; 642  : }

  00008	e49de004	 ldr         lr, [sp], #4
  0000c	e12fff1e	 bx          lr
  00010		 |$M33612|

			 ENDP  ; |?OsGetTime@PVRShellInit@@QAAKXZ|, PVRShellInit::OsGetTime

	EXPORT	|WinMain|
	IMPORT	|??1PVRShellInit@@QAA@XZ|		; PVRShellInit::~PVRShellInit
	IMPORT	|CloseMsgQueue|
	IMPORT	|?Run@PVRShellInit@@QAA_NXZ|		; PVRShellInit::Run
	IMPORT	|?CommandLine@PVRShellInit@@QAAXPAD@Z|	; PVRShellInit::CommandLine
	IMPORT	|?Init@PVRShellInit@@QAAXAAVPVRShell@@@Z| ; PVRShellInit::Init
	IMPORT	|?NewDemo@@YAPAVPVRShell@@XZ|		; NewDemo
	IMPORT	|??0PVRShellInit@@QAA@XZ|		; PVRShellInit::PVRShellInit

  00000			 AREA	 |.pdata|, PDATA
|$T33641| DCD	|$LN17@WinMain|
	DCD	0x40003d02
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |WinMain| PROC

; 834  : {

  00000		 |$LN17@WinMain|
  00000	e92d41f0	 stmdb       sp!, {r4 - r8, lr}
  00004	e24dd074	 sub         sp, sp, #0x74
  00008		 |$M33638|
  00008	e1a07003	 mov         r7, r3
  0000c	e1a05002	 mov         r5, r2
  00010	e1a08000	 mov         r8, r0

; 835  : 	size_t			i;
; 836  : 	char			*pszCmdLine;
; 837  : 	PVRShellInit	init;

  00014	e28d0000	 add         r0, sp, #0
  00018	eb000000	 bl          |??0PVRShellInit@@QAA@XZ|

; 838  : 
; 839  : #if defined(WIN32) && !defined(UNDER_CE)
; 840  : 	// Enable memory-leak reports
; 841  : 	_CrtSetDbgFlag(_CRTDBG_LEAK_CHECK_DF | _CrtSetDbgFlag(_CRTDBG_REPORT_FLAG));
; 842  : #endif
; 843  : 
; 844  : 	// Get a char-array command line as the input may be UNICODE
; 845  : 	i = _tcslen(lpCmdLine) + 1;

  0001c	e1a00005	 mov         r0, r5
  00020	eb000000	 bl          wcslen
  00024	e2804001	 add         r4, r0, #1

; 846  : 	pszCmdLine = new char[i];

  00028	e1a00004	 mov         r0, r4
  0002c	eb000000	 bl          |??2@YAPAXI@Z|
  00030	e1a06000	 mov         r6, r0

; 847  : 
; 848  : 	while(i)

  00034	e3540000	 cmp         r4, #0
  00038	0a000004	 beq         |$LN5@WinMain|

; 835  : 	size_t			i;
; 836  : 	char			*pszCmdLine;
; 837  : 	PVRShellInit	init;

  0003c	e0851084	 add         r1, r5, r4, lsl #1
  00040		 |$LL6@WinMain|

; 849  : 	{
; 850  : 		--i;
; 851  : 		pszCmdLine[i] = (char)lpCmdLine[i];

  00040	e17120b2	 ldrh        r2, [r1, #-2]!
  00044	e2544001	 subs        r4, r4, #1
  00048	e7c62004	 strb        r2, [r6, +r4]
  0004c	1afffffb	 bne         |$LL6@WinMain|
  00050		 |$LN5@WinMain|

; 852  : 	}
; 853  : 
; 854  : 	//	Create the demo, process the command line, create the OS initialiser.
; 855  : 	PVRShell *pDemo = NewDemo();

  00050	eb000000	 bl          |?NewDemo@@YAPAVPVRShell@@XZ|
  00054	e1b05000	 movs        r5, r0
  00058	03a04001	 moveq       r4, #1

; 856  : 
; 857  : 	if(!pDemo)

  0005c	0a00001d	 beq         |$LN14@WinMain|

; 858  : 		return EXIT_ERR_CODE;
; 859  : 
; 860  : 	init.Init(*pDemo);

  00060	e1a01005	 mov         r1, r5
  00064	e28d0000	 add         r0, sp, #0
  00068	eb000000	 bl          |?Init@PVRShellInit@@QAAXAAVPVRShell@@@Z|

; 861  : 	init.CommandLine(pszCmdLine);

  0006c	e1a01006	 mov         r1, r6
  00070	e28d0000	 add         r0, sp, #0
  00074	eb000000	 bl          |?CommandLine@PVRShellInit@@QAAXPAD@Z|

; 862  : 	init.m_hInstance = hInstance;

  00078	e58d8034	 str         r8, [sp, #0x34]

; 863  : 	init.m_nCmdShow = nCmdShow;

  0007c	e58d7038	 str         r7, [sp, #0x38]
  00080		 |$LL3@WinMain|

; 864  : 
; 865  : 	//	Initialise/run/shutdown
; 866  : 	while(init.Run());

  00080	e28d0000	 add         r0, sp, #0
  00084	eb000000	 bl          |?Run@PVRShellInit@@QAA_NXZ|
  00088	e3500000	 cmp         r0, #0
  0008c	1afffffb	 bne         |$LL3@WinMain|

; 867  : 
; 868  : #if defined(UNDER_CE) && !defined(NO_GDI)
; 869  : 	g_bClosing = true;

  00090	e59f4058	 ldr         r4, [pc, #0x58]
  00094	e3a03001	 mov         r3, #1

; 870  : 
; 871  : 	if(g_hPower != NULL)

  00098	e5940004	 ldr         r0, [r4, #4]
  0009c	e5c43000	 strb        r3, [r4]
  000a0	e3500000	 cmp         r0, #0
  000a4	0a000002	 beq         |$LN1@WinMain|

; 872  : 	{
; 873  : 		CloseMsgQueue(g_hPower);

  000a8	eb000000	 bl          CloseMsgQueue

; 874  : 		g_hPower = NULL;

  000ac	e3a03000	 mov         r3, #0
  000b0	e5843004	 str         r3, [r4, #4]
  000b4		 |$LN1@WinMain|

; 875  : 	}
; 876  : #endif
; 877  : 
; 878  : 	delete pDemo;

  000b4	e5953000	 ldr         r3, [r5]
  000b8	e3a01001	 mov         r1, #1
  000bc	e1a00005	 mov         r0, r5
  000c0	e5933000	 ldr         r3, [r3]
  000c4	e1a0e00f	 mov         lr, pc
  000c8	e12fff13	 bx          r3

; 879  : 	delete [] pszCmdLine;

  000cc	e1a00006	 mov         r0, r6
  000d0	eb000000	 bl          |??3@YAXPAX@Z|
  000d4	e3a04000	 mov         r4, #0
  000d8		 |$LN14@WinMain|
  000d8	e28d0000	 add         r0, sp, #0
  000dc	eb000000	 bl          |??1PVRShellInit@@QAA@XZ|

; 880  : 
; 881  : 	return EXIT_NOERR_CODE;
; 882  : }

  000e0	e1a00004	 mov         r0, r4
  000e4	e28dd074	 add         sp, sp, #0x74
  000e8	e8bd41f0	 ldmia       sp!, {r4 - r8, lr}
  000ec	e12fff1e	 bx          lr
  000f0		 |$LN18@WinMain|
  000f0		 |$LN19@WinMain|
  000f0	00000000	 DCD         |?g_bClosing@@3_NA|
  000f4		 |$M33639|

			 ENDP  ; |WinMain|

	EXPORT	|__$ArrayPad$| [ DATA ]
	EXPORT	|?PowerNotificationThread@@YAKPAX@Z|	; PowerNotificationThread
	IMPORT	|StopPowerNotifications|
	IMPORT	|PostMessageW|
	IMPORT	|ReadMsgQueue|
	IMPORT	|WaitForSingleObject|
	IMPORT	|?PVRShellGet@PVRShell@@QBA_NW4prefNameBoolEnum@@@Z| ; PVRShell::PVRShellGet
	IMPORT	|GetWindowLongW|
	IMPORT	|RequestPowerNotifications|
	IMPORT	|CreateMsgQueue|
	IMPORT	|memset|

  00000			 AREA	 |.pdata|, PDATA
|$T33665| DCD	|$LN20@PowerNotif|
	DCD	0xc0005e02

  00000			 AREA	 |.xdata|, DATA
|$T33661| DCD	0xffffffd8
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__GSHandlerCheck|
  00004	00000000	 DCD         |$T33661|

  00008		 |?PowerNotificationThread@@YAKPAX@Z| PROC ; PowerNotificationThread

; 896  : {

  00008		 |$LN20@PowerNotif|
  00008	e92d4ff0	 stmdb       sp!, {r4 - r11, lr}
  0000c	e24dd058	 sub         sp, sp, #0x58
  00010		 |$M33662|
  00010	e1a05000	 mov         r5, r0
  00014	e59f3160	 ldr         r3, [pc, #0x160]
  00018	e5933000	 ldr         r3, [r3]
  0001c	e58d3054	 str         r3, [sp, #0x54]

; 897  : 	HWND hWnd = (HWND)pContext;
; 898  : 
; 899  : 	BYTE pbMsgBuf[sizeof(POWER_BROADCAST) + sizeof(POWER_BROADCAST_POWER_INFO)];
; 900  : 
; 901  : 	MSGQUEUEOPTIONS msgopts;
; 902  : 	HANDLE hReq = NULL;
; 903  : 
; 904  : 	BOOL fContinue = false;
; 905  : 
; 906  : 	// Create our message queue
; 907  : 	memset(&msgopts, 0, sizeof(msgopts));

  00020	e3a02014	 mov         r2, #0x14
  00024	e3a01000	 mov         r1, #0
  00028	e28d000c	 add         r0, sp, #0xC
  0002c	eb000000	 bl          memset

; 908  :     msgopts.dwSize = sizeof(msgopts);
; 909  :     msgopts.dwFlags = MSGQUEUE_NOPRECOMMIT;
; 910  :     msgopts.dwMaxMessages = 0;
; 911  :     msgopts.cbMaxMessage = sizeof(pbMsgBuf);
; 912  :     msgopts.bReadAccess = TRUE;
; 913  : 
; 914  : 	if(!g_hPower)

  00030	e59f4140	 ldr         r4, [pc, #0x140]
  00034	e3a0e014	 mov         lr, #0x14
  00038	e3a06001	 mov         r6, #1
  0003c	e5940004	 ldr         r0, [r4, #4]
  00040	e3a03000	 mov         r3, #0
  00044	e3a0202c	 mov         r2, #0x2C
  00048	e3a01001	 mov         r1, #1
  0004c	e3500000	 cmp         r0, #0
  00050	e58de00c	 str         lr, [sp, #0xC]
  00054	e58d6010	 str         r6, [sp, #0x10]
  00058	e58d3014	 str         r3, [sp, #0x14]
  0005c	e58d2018	 str         r2, [sp, #0x18]
  00060	e58d101c	 str         r1, [sp, #0x1C]
  00064	1a000005	 bne         |$LN15@PowerNotif|

; 915  : 		g_hPower = CreateMsgQueue(NULL, &msgopts);

  00068	e28d100c	 add         r1, sp, #0xC
  0006c	e3a00000	 mov         r0, #0
  00070	eb000000	 bl          CreateMsgQueue
  00074	e3500000	 cmp         r0, #0
  00078	e5840004	 str         r0, [r4, #4]

; 916  : 
; 917  : 	if(g_hPower != NULL)

  0007c	0a000037	 beq         |$LN10@PowerNotif|
  00080		 |$LN15@PowerNotif|

; 918  : 	{
; 919  : 		// Request power notifications
; 920  : 		hReq = RequestPowerNotifications(g_hPower, PBT_TRANSITION);

  00080	e3a01001	 mov         r1, #1
  00084	eb000000	 bl          RequestPowerNotifications
  00088	e1b06000	 movs        r6, r0
  0008c	e58d6008	 str         r6, [sp, #8]

; 921  : 
; 922  : 		if(hReq != NULL)

  00090	0a00002e	 beq         |$LN9@PowerNotif|

; 923  : 		{
; 924  : 			PVRShellInit	*pData;
; 925  : 			pData = (PVRShellInit*)(__int64) GetWindowLong(hWnd, GWL_USERDATA);

  00094	e3e01014	 mvn         r1, #0x14
  00098	e1a00005	 mov         r0, r5
  0009c	eb000000	 bl          GetWindowLongW

; 926  : 
; 927  : 			while(!g_bClosing)

  000a0	e5d43000	 ldrb        r3, [r4]
  000a4	e1a07000	 mov         r7, r0
  000a8	e3530000	 cmp         r3, #0
  000ac	1a000025	 bne         |$LN7@PowerNotif|
  000b0	e3a0a902	 mov         r10, #2, 18
  000b4	e3a0b902	 mov         r11, #2, 18
  000b8	e3a09001	 mov         r9, #1
  000bc	e28d8024	 add         r8, sp, #0x24
  000c0	e3a06000	 mov         r6, #0
  000c4		 |$LL8@PowerNotif|

; 928  : 			{
; 929  : 				if(!pData->m_pShell->PVRShellGet(prefPowerSaving))

  000c4	e5970040	 ldr         r0, [r7, #0x40]
  000c8	e3a0100b	 mov         r1, #0xB
  000cc	eb000000	 bl          |?PVRShellGet@PVRShell@@QBA_NW4prefNameBoolEnum@@@Z|
  000d0	e3500000	 cmp         r0, #0

; 930  : 					g_bClosing = true;

  000d4	05c49000	 streqb      r9, [r4]
  000d8	0a000016	 beq         |$LN16@PowerNotif|

; 931  : 				else
; 932  : 				{
; 933  : 					DWORD dwSize, dwFlags;
; 934  : 
; 935  : 					/*
; 936  : 						Note the importance of having an INFINITE timeout here.  If you have a shorter timeout,
; 937  : 						you're polling, which burns power the same way the animation does.  You'd be creating
; 938  : 						the problem you're trying to solve.
; 939  : 					*/
; 940  : 					WaitForSingleObject(g_hPower, INFINITE);

  000dc	e5940004	 ldr         r0, [r4, #4]
  000e0	e3e01000	 mvn         r1, #0
  000e4	eb000000	 bl          WaitForSingleObject

; 941  : 
; 942  : 					if(ReadMsgQueue(g_hPower, pbMsgBuf, sizeof(pbMsgBuf), &dwSize, 0, &dwFlags))

  000e8	e5940004	 ldr         r0, [r4, #4]
  000ec	e28d3020	 add         r3, sp, #0x20
  000f0	e3a0202c	 mov         r2, #0x2C
  000f4	e28d1028	 add         r1, sp, #0x28
  000f8	e58d8004	 str         r8, [sp, #4]
  000fc	e58d6000	 str         r6, [sp]
  00100	eb000000	 bl          ReadMsgQueue
  00104	e3500000	 cmp         r0, #0
  00108	0a00000a	 beq         |$LN16@PowerNotif|

; 943  : 					{
; 944  : 						POWER_BROADCAST *pPower = (POWER_BROADCAST*)pbMsgBuf;
; 945  : 
; 946  : 						/*
; 947  : 							If the screen is on then post a message to say we want to render. However,
; 948  : 							if it is off, or the device has suspended or the state says the user has
; 949  : 							gone idle then cease rendering.
; 950  : 						*/
; 951  : 						if((pPower->Flags & POWER_STATE_ON))

  0010c	e59d302c	 ldr         r3, [sp, #0x2C]
  00110	e3130801	 tst         r3, #1, 16

; 952  : 							PostMessage(hWnd, WM_APP_RENDER, 0, 0);

  00114	138a1002	 orrne       r1, r10, #2
  00118	1a000002	 bne         |$LN17@PowerNotif|

; 953  : 						else if((pPower->Flags & (POWER_STATE_OFF | POWER_STATE_SUSPEND | POWER_STATE_IDLE)))

  0011c	e3130832	 tst         r3, #0x32, 16
  00120	0a000004	 beq         |$LN16@PowerNotif|

; 954  : 							PostMessage(hWnd, WM_APP_DONTRENDER, 0, 0);

  00124	e38b1001	 orr         r1, r11, #1
  00128		 |$LN17@PowerNotif|
  00128	e3a03000	 mov         r3, #0
  0012c	e3a02000	 mov         r2, #0
  00130	e1a00005	 mov         r0, r5
  00134	eb000000	 bl          PostMessageW
  00138		 |$LN16@PowerNotif|
  00138	e5d43000	 ldrb        r3, [r4]
  0013c	e3530000	 cmp         r3, #0
  00140	0affffdf	 beq         |$LL8@PowerNotif|

; 918  : 	{
; 919  : 		// Request power notifications
; 920  : 		hReq = RequestPowerNotifications(g_hPower, PBT_TRANSITION);

  00144	e59d6008	 ldr         r6, [sp, #8]
  00148		 |$LN7@PowerNotif|

; 955  : 	#if 0
; 956  : 						else if((pPower->Flags & POWER_STATE_USERIDLE))
; 957  : 							PostMessage(hWnd, WM_APP_DONTRENDER, 0, 0);
; 958  : 	#endif
; 959  : 					}
; 960  : 				}
; 961  : 			}
; 962  : 
; 963  : 			StopPowerNotifications(hReq);

  00148	e1a00006	 mov         r0, r6
  0014c	eb000000	 bl          StopPowerNotifications
  00150		 |$LN9@PowerNotif|

; 964  : 		}
; 965  : 
; 966  : 		CloseMsgQueue(g_hPower);

  00150	e5940004	 ldr         r0, [r4, #4]
  00154	eb000000	 bl          CloseMsgQueue

; 967  : 		g_hPower = NULL;

  00158	e3a03000	 mov         r3, #0
  0015c	e5843004	 str         r3, [r4, #4]
  00160		 |$LN10@PowerNotif|

; 968  : 	}
; 969  : 
; 970  : 	return (0);

  00160	e59d0054	 ldr         r0, [sp, #0x54]
  00164	eb000000	 bl          __security_check_cookie
  00168	e3a00000	 mov         r0, #0

; 971  : }

  0016c	e28dd058	 add         sp, sp, #0x58
  00170	e8bd4ff0	 ldmia       sp!, {r4 - r11, lr}
  00174	e12fff1e	 bx          lr
  00178		 |$LN21@PowerNotif|
  00178		 |$LN22@PowerNotif|
  00178	00000000	 DCD         |?g_bClosing@@3_NA|
  0017c		 |$LN23@PowerNotif|
  0017c	00000000	 DCD         |__security_cookie|
  00180		 |$M33663|

			 ENDP  ; |?PowerNotificationThread@@YAKPAX@Z|, PowerNotificationThread

	EXPORT	|__$ArrayPad$| [ DATA ]
	EXPORT	|?PVRShellOutputDebug@PVRShell@@QBAXQBDZZ| ; PVRShell::PVRShellOutputDebug
	IMPORT	|_vsnprintf|

  00000			 AREA	 |.pdata|, PDATA
|$T33680| DCD	|$LN5@PVRShellOu|
	DCD	0xc0001c05

  00000			 AREA	 |.xdata|, DATA
|$T33676| DCD	0xffffffe0
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__GSHandlerCheck|
  00004	00000000	 DCD         |$T33676|

  00008		 |?PVRShellOutputDebug@PVRShell@@QBAXQBDZZ| PROC ; PVRShell::PVRShellOutputDebug

; 95   : {

  00008		 |$LN5@PVRShellOu|
  00008	e1a0c00d	 mov         r12, sp
  0000c	e92d000f	 stmdb       sp!, {r0 - r3}
  00010	e92d5010	 stmdb       sp!, {r4, r12, lr}
  00014	e59fc058	 ldr         r12, [pc, #0x58]
  00018	e08dd00c	 add         sp, sp, r12
  0001c		 |$M33677|
  0001c	e58d1414	 str         r1, [sp, #0x414]
  00020	e1a04000	 mov         r4, r0
  00024	e59f3044	 ldr         r3, [pc, #0x44]
  00028	e5933000	 ldr         r3, [r3]
  0002c	e58d3400	 str         r3, [sp, #0x400]

; 96   : 	va_list arg;
; 97   : 	char	buf[1024];
; 98   : 
; 99   : 	va_start(arg, format);
; 100  : 	vsnprintf(buf, 1024, format, arg);

  00030	e1a02001	 mov         r2, r1
  00034	e3a01b01	 mov         r1, #1, 22
  00038	e3813018	 orr         r3, r1, #0x18
  0003c	e08d3003	 add         r3, sp, r3
  00040	e28d0000	 add         r0, sp, #0
  00044	eb000000	 bl          _vsnprintf

; 101  : 	va_end(arg);
; 102  : 
; 103  : 	// Passes the data to a platform dependant function
; 104  : 	m_pShellInit->OsDisplayDebugString(buf);

  00048	e5940008	 ldr         r0, [r4, #8]
  0004c	e28d1000	 add         r1, sp, #0
  00050	eb000000	 bl          |?OsDisplayDebugString@PVRShellInit@@QAAXQBD@Z|
  00054	e59d0400	 ldr         r0, [sp, #0x400]
  00058	eb000000	 bl          __security_check_cookie

; 105  : }

  0005c	e3a0cb01	 mov         r12, #1, 22
  00060	e38cc004	 orr         r12, r12, #4
  00064	e08dd00c	 add         sp, sp, r12
  00068	e89d6010	 ldmia       sp, {r4, sp, lr}
  0006c	e12fff1e	 bx          lr
  00070		 |$LN6@PVRShellOu|
  00070		 |$LN7@PVRShellOu|
  00070	00000000	 DCD         |__security_cookie|
  00074		 |$LN8@PVRShellOu|
  00074	fffffbfc	 DCD         0xfffffbfc
  00078		 |$M33678|

			 ENDP  ; |?PVRShellOutputDebug@PVRShell@@QBAXQBDZZ|, PVRShell::PVRShellOutputDebug

	EXPORT	|?WndProc@@YAJPAUHWND__@@IIJ@Z|		; WndProc
	IMPORT	|DefWindowProcW|
	IMPORT	|CloseHandle|
	IMPORT	|CreateThread|
	IMPORT	|SetWindowLongW|

  00000			 AREA	 |.pdata|, PDATA
|$T33707| DCD	|$LN47@WndProc|
	DCD	0x4000a302
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?WndProc@@YAJPAUHWND__@@IIJ@Z| PROC	; WndProc

; 691  : {

  00000		 |$LN47@WndProc|
  00000	e92d41f0	 stmdb       sp!, {r4 - r8, lr}
  00004	e24dd008	 sub         sp, sp, #8
  00008		 |$M33704|
  00008	e1a07003	 mov         r7, r3
  0000c	e1a04002	 mov         r4, r2
  00010	e1a06001	 mov         r6, r1
  00014	e1a08000	 mov         r8, r0

; 692  : 	PVRShellInit	*pData;
; 693  : 
; 694  : 	pData = (PVRShellInit*)(__int64)GetWindowLong(hWnd, GWL_USERDATA);

  00018	e3e01014	 mvn         r1, #0x14
  0001c	eb000000	 bl          GetWindowLongW
  00020	e1a05000	 mov         r5, r0

; 695  : 
; 696  : 	switch (message)

  00024	e3560012	 cmp         r6, #0x12
  00028	8a000027	 bhi         |$LN40@WndProc|
  0002c	0a000011	 beq         |$LN29@WndProc|
  00030	e3560001	 cmp         r6, #1
  00034	0a000011	 beq         |$LN32@WndProc|
  00038	e3560002	 cmp         r6, #2
  0003c	0a00000d	 beq         |$LN29@WndProc|
  00040	e3560007	 cmp         r6, #7
  00044	0a000009	 beq         |$LN15@WndProc|
  00048	e3560008	 cmp         r6, #8
  0004c	0a000005	 beq         |$LN14@WndProc|
  00050	e3560010	 cmp         r6, #0x10
  00054	1a000081	 bne         |$LN11@WndProc|

; 732  : #endif
; 733  : 	case WM_CLOSE:
; 734  : 		pData->gShellDone = true;

  00058	e3a03001	 mov         r3, #1
  0005c	e5c53058	 strb        r3, [r5, #0x58]
  00060	e3a00000	 mov         r0, #0
  00064	ea000082	 b           |$LN35@WndProc|
  00068		 |$LN14@WndProc|

; 770  : 		return 0;
; 771  : 	case WM_KILLFOCUS:
; 772  : 		pData->m_bHaveFocus = false;

  00068	e3a03000	 mov         r3, #0

; 773  : 		return 0;

  0006c	ea000000	 b           |$LN44@WndProc|
  00070		 |$LN15@WndProc|

; 764  : 			}
; 765  : 			break;
; 766  : 		}
; 767  : #endif
; 768  : 	case WM_SETFOCUS:
; 769  : 		pData->m_bHaveFocus = true;

  00070	e3a03001	 mov         r3, #1
  00074		 |$LN44@WndProc|
  00074	e5c5303c	 strb        r3, [r5, #0x3C]
  00078		 |$LN29@WndProc|

; 719  : 		}
; 720  : 	case WM_PAINT:
; 721  : 		break;
; 722  : 	case WM_DESTROY:
; 723  : 		return 0;

  00078	e3a00000	 mov         r0, #0
  0007c	ea00007c	 b           |$LN35@WndProc|
  00080		 |$LN32@WndProc|

; 697  : 	{
; 698  : 	case WM_CREATE:
; 699  : 		{
; 700  : 			CREATESTRUCT	*pCreate = (CREATESTRUCT*)lParam;
; 701  : 			SetWindowLong(hWnd, GWL_USERDATA, (LONG)pCreate->lpCreateParams); // Not ideal, but WinCE doesn't have SetWindowLongPtr

  00080	e5972000	 ldr         r2, [r7]
  00084	e3e01014	 mvn         r1, #0x14
  00088	e1a00008	 mov         r0, r8
  0008c	eb000000	 bl          SetWindowLongW

; 702  : 
; 703  : #ifdef UNDER_CE
; 704  : 			g_bClosing = false;

  00090	e59f31f0	 ldr         r3, [pc, #0x1F0]

; 705  : 			// To receive power notifications, you need a second thread.
; 706  : 			// Dealing with multiple threads is a large part of the
; 707  : 			// complexity of this approach to stopping animations.
; 708  : 			HANDLE hThread;
; 709  : 			hThread = CreateThread(NULL, 0, PowerNotificationThread, hWnd, 0, NULL);

  00094	e59f21e8	 ldr         r2, [pc, #0x1E8]
  00098	e3a01000	 mov         r1, #0
  0009c	e5c31000	 strb        r1, [r3]
  000a0	e3a0e000	 mov         lr, #0
  000a4	e1a03008	 mov         r3, r8
  000a8	e3a01000	 mov         r1, #0
  000ac	e3a00000	 mov         r0, #0
  000b0	e58de004	 str         lr, [sp, #4]
  000b4	e58de000	 str         lr, [sp]
  000b8	eb000000	 bl          CreateThread
  000bc	e3500000	 cmp         r0, #0

; 710  : 
; 711  : 			// Close the thread handle since we don’t need it to monitor the thread’s exit.
; 712  : 			// If we don’t close it here the OS will not be able to release internal resources
; 713  : 			// until the process terminates.
; 714  : 			if (hThread != NULL)

  000c0	0a000066	 beq         |$LN11@WndProc|

; 715  : 				CloseHandle(hThread);

  000c4	eb000000	 bl          CloseHandle

; 716  : #endif
; 717  : 
; 718  : 			break;

  000c8	ea000064	 b           |$LN11@WndProc|
  000cc		 |$LN40@WndProc|

; 695  : 
; 696  : 	switch (message)

  000cc	e3560c01	 cmp         r6, #1, 24
  000d0	0a00002c	 beq         |$LN13@WndProc|
  000d4	e3a03c02	 mov         r3, #2, 24
  000d8	e3833001	 orr         r3, r3, #1
  000dc	e1560003	 cmp         r6, r3
  000e0	0a000020	 beq         |$LN24@WndProc|
  000e4	e3a03c03	 mov         r3, #3, 24
  000e8	e3833012	 orr         r3, r3, #0x12
  000ec	e1560003	 cmp         r6, r3
  000f0	0a00000d	 beq         |$LN22@WndProc|
  000f4	e3a03902	 mov         r3, #2, 18
  000f8	e3833001	 orr         r3, r3, #1
  000fc	e1560003	 cmp         r6, r3
  00100	0a000005	 beq         |$LN28@WndProc|
  00104	e3a03902	 mov         r3, #2, 18
  00108	e3833002	 orr         r3, r3, #2
  0010c	e1560003	 cmp         r6, r3
  00110	1a000052	 bne         |$LN11@WndProc|

; 729  : 	case WM_APP_RENDER:
; 730  : 		g_bRendering = true;

  00114	e3a02001	 mov         r2, #1

; 731  : 		break;

  00118	ea000000	 b           |$LN43@WndProc|
  0011c		 |$LN28@WndProc|

; 724  : #ifdef UNDER_CE
; 725  : 	// The two messages that the power notification thread may post
; 726  : 	case WM_APP_DONTRENDER:
; 727  : 		g_bRendering = false;

  0011c	e3a02000	 mov         r2, #0
  00120		 |$LN43@WndProc|
  00120	e59f3158	 ldr         r3, [pc, #0x158]
  00124	e5c32000	 strb        r2, [r3]

; 728  : 		break;

  00128	ea00004c	 b           |$LN11@WndProc|
  0012c		 |$LN22@WndProc|

; 745  : 		}
; 746  : #ifdef UNDER_CE
; 747  : 	// For the Axim (X50v, X51v)
; 748  : 	case WM_HOTKEY:
; 749  : 		{
; 750  : 			switch(HIWORD(lParam))

  0012c	e1a03827	 mov         r3, r7, lsr #16
  00130	e35300c1	 cmp         r3, #0xC1
  00134	0a000047	 beq         |$LN2@WndProc|
  00138	e35300c2	 cmp         r3, #0xC2
  0013c	0a000007	 beq         |$LN18@WndProc|
  00140	e35300c3	 cmp         r3, #0xC3
  00144	0a000003	 beq         |$LN17@WndProc|
  00148	e35300c4	 cmp         r3, #0xC4
  0014c	1a000043	 bne         |$LN11@WndProc|
  00150		 |$LN10@WndProc|

; 761  : 			case 0xC4:
; 762  : 				pData->nLastKeyPressed = PVRShellKeyNameQUIT;

  00150	e3a03001	 mov         r3, #1

; 763  : 				break;

  00154	ea000040	 b           |$LN41@WndProc|
  00158		 |$LN17@WndProc|

; 758  : 			case 0xC3:
; 759  : 				pData->nLastKeyPressed = PVRShellKeyNameACTION2;

  00158	e3a03004	 mov         r3, #4

; 760  : 				break;

  0015c	ea00003e	 b           |$LN41@WndProc|
  00160		 |$LN18@WndProc|

; 751  : 			{
; 752  : 			case 0xC1:
; 753  : 				pData->nLastKeyPressed = PVRShellKeyNameScreenshot;
; 754  : 				break;
; 755  : 			case 0xC2:
; 756  : 				pData->nLastKeyPressed = PVRShellKeyNameACTION1;

  00160	e3a03003	 mov         r3, #3

; 757  : 				break;

  00164	ea00003c	 b           |$LN41@WndProc|
  00168		 |$LN24@WndProc|

; 735  : 		return 0;
; 736  : 	case WM_QUIT:
; 737  : 		return 0;
; 738  : 	case WM_LBUTTONDOWN:
; 739  : 		{
; 740  : 			if(pData->m_pShell->PVRShellGet(prefFullScreen))

  00168	e5950040	 ldr         r0, [r5, #0x40]
  0016c	e3a01000	 mov         r1, #0
  00170	eb000000	 bl          |?PVRShellGet@PVRShell@@QBA_NW4prefNameBoolEnum@@@Z|
  00174	e3500000	 cmp         r0, #0
  00178	0a000038	 beq         |$LN11@WndProc|

; 741  : 			{
; 742  : 				pData->gShellDone = true;

  0017c	e3a03001	 mov         r3, #1
  00180	e5c53058	 strb        r3, [r5, #0x58]

; 743  : 			}
; 744  : 			break;

  00184	ea000035	 b           |$LN11@WndProc|
  00188		 |$LN13@WndProc|

; 774  : 	case WM_KEYDOWN:
; 775  : 	{
; 776  : 		switch(wParam)

  00188	e3540034	 cmp         r4, #0x34
  0018c	8a000018	 bhi         |$LN37@WndProc|
  00190	0afffff2	 beq         |$LN18@WndProc|
  00194	e3540027	 cmp         r4, #0x27
  00198	8a00000a	 bhi         |$LN38@WndProc|
  0019c	0a000023	 beq         |$LN6@WndProc|
  001a0	e354001b	 cmp         r4, #0x1B
  001a4	0affffe9	 beq         |$LN10@WndProc|
  001a8	e3540020	 cmp         r4, #0x20
  001ac	0a00001b	 beq         |$LN5@WndProc|
  001b0	e3540025	 cmp         r4, #0x25
  001b4	0a00001b	 beq         |$LN7@WndProc|
  001b8	e3540026	 cmp         r4, #0x26
  001bc	1a000027	 bne         |$LN11@WndProc|
  001c0		 |$LN9@WndProc|

; 777  : 		{
; 778  : 		case VK_ESCAPE:
; 779  : 		case 0xC1:
; 780  : 			pData->nLastKeyPressed = PVRShellKeyNameQUIT;
; 781  : 			break;
; 782  : 		case VK_UP:
; 783  : 		case 0x35:
; 784  : 			pData->nLastKeyPressed = PVRShellKeyNameUP;

  001c0	e3a03005	 mov         r3, #5

; 785  : 			break;

  001c4	ea000024	 b           |$LN41@WndProc|
  001c8		 |$LN38@WndProc|

; 774  : 	case WM_KEYDOWN:
; 775  : 	{
; 776  : 		switch(wParam)

  001c8	e3540028	 cmp         r4, #0x28
  001cc	0a000006	 beq         |$LN8@WndProc|
  001d0	e3540030	 cmp         r4, #0x30
  001d4	0a000004	 beq         |$LN8@WndProc|
  001d8	e3540031	 cmp         r4, #0x31
  001dc	0affffdf	 beq         |$LN18@WndProc|
  001e0	e3540032	 cmp         r4, #0x32
  001e4	0affffdb	 beq         |$LN17@WndProc|
  001e8	ea00001c	 b           |$LN11@WndProc|
  001ec		 |$LN8@WndProc|

; 786  : 		case VK_DOWN:
; 787  : 		case 0x30:
; 788  : 			pData->nLastKeyPressed = PVRShellKeyNameDOWN;

  001ec	e3a03006	 mov         r3, #6

; 789  : 			break;

  001f0	ea000019	 b           |$LN41@WndProc|
  001f4		 |$LN37@WndProc|

; 774  : 	case WM_KEYDOWN:
; 775  : 	{
; 776  : 		switch(wParam)

  001f4	e3540039	 cmp         r4, #0x39
  001f8	8a00000e	 bhi         |$LN39@WndProc|
  001fc	0a00000b	 beq         |$LN6@WndProc|
  00200	e3540035	 cmp         r4, #0x35
  00204	0affffed	 beq         |$LN9@WndProc|
  00208	e3540036	 cmp         r4, #0x36
  0020c	0affffd1	 beq         |$LN17@WndProc|
  00210	e3540037	 cmp         r4, #0x37
  00214	0a000003	 beq         |$LN7@WndProc|
  00218	e3540038	 cmp         r4, #0x38
  0021c	1a00000f	 bne         |$LN11@WndProc|
  00220		 |$LN5@WndProc|

; 798  : 		case VK_F23:	// X50v select button
; 799  : 		case VK_SPACE:
; 800  : 		case 0x38:
; 801  : 			pData->nLastKeyPressed = PVRShellKeyNameSELECT;

  00220	e3a03002	 mov         r3, #2

; 802  : 			break;

  00224	ea00000c	 b           |$LN41@WndProc|
  00228		 |$LN7@WndProc|

; 790  : 		case VK_LEFT:
; 791  : 		case 0x37:
; 792  : 			pData->nLastKeyPressed = PVRShellKeyNameLEFT;

  00228	e3a03007	 mov         r3, #7

; 793  : 			break;

  0022c	ea00000a	 b           |$LN41@WndProc|
  00230		 |$LN6@WndProc|

; 794  : 		case VK_RIGHT:
; 795  : 		case 0x39:
; 796  : 			pData->nLastKeyPressed = PVRShellKeyNameRIGHT;

  00230	e3a03008	 mov         r3, #8

; 797  : 			break;

  00234	ea000008	 b           |$LN41@WndProc|
  00238		 |$LN39@WndProc|

; 774  : 	case WM_KEYDOWN:
; 775  : 	{
; 776  : 		switch(wParam)

  00238	e354007a	 cmp         r4, #0x7A
  0023c	0a000005	 beq         |$LN2@WndProc|
  00240	e3540086	 cmp         r4, #0x86
  00244	0afffff5	 beq         |$LN5@WndProc|
  00248	e35400c1	 cmp         r4, #0xC1
  0024c	0affffbf	 beq         |$LN10@WndProc|
  00250	e35400c2	 cmp         r4, #0xC2
  00254	1a000001	 bne         |$LN11@WndProc|
  00258		 |$LN2@WndProc|

; 803  : 		case '1':
; 804  : 		case 0x34:
; 805  : 			pData->nLastKeyPressed = PVRShellKeyNameACTION1;
; 806  : 			break;
; 807  : 		case '2':
; 808  : 		case 0x36:
; 809  : 			pData->nLastKeyPressed = PVRShellKeyNameACTION2;
; 810  : 			break;
; 811  : 		case VK_F11:
; 812  : 		case 0xC2:
; 813  : 			pData->nLastKeyPressed = PVRShellKeyNameScreenshot;

  00258	e3a03009	 mov         r3, #9
  0025c		 |$LN41@WndProc|
  0025c	e5853060	 str         r3, [r5, #0x60]
  00260		 |$LN11@WndProc|

; 814  : 			break;
; 815  : 		}
; 816  : 	}
; 817  : 	default:
; 818  : 		break;
; 819  : 	}
; 820  : 
; 821  : 	return DefWindowProc(hWnd, message, wParam, lParam);

  00260	e1a03007	 mov         r3, r7
  00264	e1a02004	 mov         r2, r4
  00268	e1a01006	 mov         r1, r6
  0026c	e1a00008	 mov         r0, r8
  00270	eb000000	 bl          DefWindowProcW
  00274		 |$LN35@WndProc|

; 822  : }

  00274	e28dd008	 add         sp, sp, #8
  00278	e8bd41f0	 ldmia       sp!, {r4 - r8, lr}
  0027c	e12fff1e	 bx          lr
  00280		 |$LN48@WndProc|
  00280		 |$LN49@WndProc|
  00280	00000000	 DCD         |?g_bRendering@@3_NA|
  00284		 |$LN50@WndProc|
  00284	00000000	 DCD         |?PowerNotificationThread@@YAKPAX@Z|
  00288		 |$LN51@WndProc|
  00288	00000000	 DCD         |?g_bClosing@@3_NA|
  0028c		 |$M33705|

			 ENDP  ; |?WndProc@@YAJPAUHWND__@@IIJ@Z|, WndProc

	EXPORT	|?MyRegisterClass@PVRShellInitOS@@QAAGXZ| ; PVRShellInitOS::MyRegisterClass
	EXPORT	|??_C@_19FMANOJFK@?$AAI?$AAC?$AAO?$AAN?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1BM@GPEKOMLI@?$AAP?$AAV?$AAR?$AAS?$AAh?$AAe?$AAl?$AAl?$AAC?$AAl?$AAa?$AAs?$AAs?$AA?$AA@| [ DATA ] ; `string'
	IMPORT	|RegisterClassW|
	IMPORT	|GetStockObject|
	IMPORT	|LoadIconW|

  00000			 AREA	 |.pdata|, PDATA
|$T33721| DCD	|$LN5@MyRegister|
	DCD	0x40002502

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_19FMANOJFK@?$AAI?$AAC?$AAO?$AAN?$AA?$AA@| DCB "I", 0x0, "C", 0x0, "O"
	DCB	0x0, "N", 0x0, 0x0, 0x0			; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1BM@GPEKOMLI@?$AAP?$AAV?$AAR?$AAS?$AAh?$AAe?$AAl?$AAl?$AAC?$AAl?$AAa?$AAs?$AAs?$AA?$AA@| DCB "P"
	DCB	0x0, "V", 0x0, "R", 0x0, "S", 0x0, "h", 0x0, "e", 0x0, "l"
	DCB	0x0, "l", 0x0, "C", 0x0, "l", 0x0, "a", 0x0, "s", 0x0, "s"
	DCB	0x0, 0x0, 0x0				; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?MyRegisterClass@PVRShellInitOS@@QAAGXZ| PROC ; PVRShellInitOS::MyRegisterClass

; 659  : {

  00000		 |$LN5@MyRegister|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004	e24dd028	 sub         sp, sp, #0x28
  00008		 |$M33718|

; 660  : 	WNDCLASS wc;
; 661  : 
; 662  :     wc.style			= CS_HREDRAW | CS_VREDRAW;
; 663  : 	wc.lpfnWndProc		= (WNDPROC)WndProc;
; 664  :     wc.cbClsExtra		= 0;
; 665  :     wc.cbWndExtra		= 0;
; 666  :     wc.hInstance		= m_hInstance;

  00008	e5902018	 ldr         r2, [r0, #0x18]
  0000c	e59f307c	 ldr         r3, [pc, #0x7C]

; 667  :     wc.hIcon			= LoadIcon(m_hInstance, _T("ICON"));

  00010	e59f1074	 ldr         r1, [pc, #0x74]
  00014	e3a0e003	 mov         lr, #3
  00018	e3a04000	 mov         r4, #0
  0001c	e3a05000	 mov         r5, #0
  00020	e1a00002	 mov         r0, r2
  00024	e58de000	 str         lr, [sp]
  00028	e58d3004	 str         r3, [sp, #4]
  0002c	e58d4008	 str         r4, [sp, #8]
  00030	e58d500c	 str         r5, [sp, #0xC]
  00034	e58d2010	 str         r2, [sp, #0x10]
  00038	eb000000	 bl          LoadIconW
  0003c	e1a03000	 mov         r3, r0

; 668  :     wc.hCursor			= 0;

  00040	e3a02000	 mov         r2, #0

; 669  :     wc.lpszMenuName		= 0;

  00044	e3a01000	 mov         r1, #0

; 670  : 	wc.hbrBackground	= (HBRUSH) GetStockObject(WHITE_BRUSH);

  00048	e3a00000	 mov         r0, #0
  0004c	e58d3014	 str         r3, [sp, #0x14]
  00050	e58d2018	 str         r2, [sp, #0x18]
  00054	e58d1020	 str         r1, [sp, #0x20]
  00058	eb000000	 bl          GetStockObject

; 671  :     wc.lpszClassName	= WINDOW_CLASS;

  0005c	e59f3024	 ldr         r3, [pc, #0x24]
  00060	e1a02000	 mov         r2, r0

; 672  : 
; 673  : 	return RegisterClass(&wc);

  00064	e28d0000	 add         r0, sp, #0
  00068	e58d3024	 str         r3, [sp, #0x24]
  0006c	e58d201c	 str         r2, [sp, #0x1C]
  00070	eb000000	 bl          RegisterClassW
  00074	e1a00800	 mov         r0, r0, lsl #16
  00078	e1a00820	 mov         r0, r0, lsr #16

; 674  : }

  0007c	e28dd028	 add         sp, sp, #0x28
  00080	e8bd4030	 ldmia       sp!, {r4, r5, lr}
  00084	e12fff1e	 bx          lr
  00088		 |$LN6@MyRegister|
  00088		 |$LN7@MyRegister|
  00088	00000000	 DCD         |??_C@_1BM@GPEKOMLI@?$AAP?$AAV?$AAR?$AAS?$AAh?$AAe?$AAl?$AAl?$AAC?$AAl?$AAa?$AAs?$AAs?$AA?$AA@|
  0008c		 |$LN8@MyRegister|
  0008c	00000000	 DCD         |??_C@_19FMANOJFK@?$AAI?$AAC?$AAO?$AAN?$AA?$AA@|
  00090		 |$LN9@MyRegister|
  00090	00000000	 DCD         |?WndProc@@YAJPAUHWND__@@IIJ@Z|
  00094		 |$M33719|

			 ENDP  ; |?MyRegisterClass@PVRShellInitOS@@QAAGXZ|, PVRShellInitOS::MyRegisterClass

	EXPORT	|?OsInitOS@PVRShellInit@@QAA_NXZ|	; PVRShellInit::OsInitOS
	EXPORT	|??_C@_09GOBDHBAA@?5?9?5Build?5?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1M@BAKKPHMH@?$AAB?$AAK?$AAL?$AA1?$AA?3?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1HA@NLKMIAAA@?$AA?$HL?$AAE?$AAB?$AA9?$AA1?$AAC?$AA7?$AAC?$AA9?$AA?9?$AA8?$AAB?$AAF?$AA6?$AA?9?$AA4?$AAa?$AA2?$AAd?$AA?9?$AA9?$AAA?$AAB?$AA8?$AA?9?$AA6?$AA9?$AA7?$AA2?$AA4?$AAE?$AAE@| [ DATA ] ; `string'
	IMPORT	|ClientToScreen|
	IMPORT	|UpdateWindow|
	IMPORT	|ShowWindow|
	IMPORT	|GetDC|
	IMPORT	|SetWindowPos|
	IMPORT	|RegisterHotKey|
	IMPORT	|AdjustWindowRectEx|
	IMPORT	|SetRect|
	IMPORT	|CreateWindowExW|
	IMPORT	|GetMonitorInfo|
	IMPORT	|MonitorFromPoint|
	IMPORT	|SetPowerRequirement|

  00000			 AREA	 |.pdata|, PDATA
|$T33767| DCD	|$LN35@OsInitOS|
	DCD	0x40011802

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_09GOBDHBAA@?5?9?5Build?5?$AA@| DCB " - Build ", 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1M@BAKKPHMH@?$AAB?$AAK?$AAL?$AA1?$AA?3?$AA?$AA@| DCB "B", 0x0, "K", 0x0
	DCB	"L", 0x0, "1", 0x0, ":", 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1HA@NLKMIAAA@?$AA?$HL?$AAE?$AAB?$AA9?$AA1?$AAC?$AA7?$AAC?$AA9?$AA?9?$AA8?$AAB?$AAF?$AA6?$AA?9?$AA4?$AAa?$AA2?$AAd?$AA?9?$AA9?$AAA?$AAB?$AA8?$AA?9?$AA6?$AA9?$AA7?$AA2?$AA4?$AAE?$AAE@| DCB "{"
	DCB	0x0, "E", 0x0, "B", 0x0, "9", 0x0, "1", 0x0, "C", 0x0, "7"
	DCB	0x0, "C", 0x0, "9", 0x0, "-", 0x0, "8", 0x0, "B", 0x0, "F"
	DCB	0x0, "6", 0x0, "-", 0x0, "4", 0x0, "a", 0x0, "2", 0x0, "d"
	DCB	0x0, "-", 0x0, "9", 0x0, "A", 0x0, "B", 0x0, "8", 0x0, "-"
	DCB	0x0, "6", 0x0, "9", 0x0, "7", 0x0, "2", 0x0, "4", 0x0, "E"
	DCB	0x0, "E", 0x0, "D", 0x0, "9", 0x0, "7", 0x0, "D", 0x0, "1"
	DCB	0x0, "}", 0x0, "\\", 0x0, "\\", 0x0, "W", 0x0, "i", 0x0, "n"
	DCB	0x0, "d", 0x0, "o", 0x0, "w", 0x0, "s", 0x0, "\\", 0x0, "d"
	DCB	0x0, "d", 0x0, "i", 0x0, ".", 0x0, "d", 0x0, "l", 0x0, "l"
	DCB	0x0, 0x0, 0x0				; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?OsInitOS@PVRShellInit@@QAA_NXZ| PROC	; PVRShellInit::OsInitOS

; 179  : {

  00000		 |$LN35@OsInitOS|
  00000	e92d47f0	 stmdb       sp!, {r4 - r10, lr}
  00004	e24dd060	 sub         sp, sp, #0x60
  00008		 |$M33764|
  00008	e1a06000	 mov         r6, r0

; 180  : 	MONITORINFO sMInfo;
; 181  : 	TCHAR		*appName;
; 182  : 	RECT		winRect;
; 183  : 	POINT		p;
; 184  : 
; 185  : 	MyRegisterClass();

  0000c	e286001c	 add         r0, r6, #0x1C
  00010	eb000000	 bl          |?MyRegisterClass@PVRShellInitOS@@QAAGXZ|

; 186  : 
; 187  : #ifdef UNDER_CE
; 188  : 	if(!m_pShell->m_pShellData->bUsingPowerSaving)

  00014	e5963040	 ldr         r3, [r6, #0x40]
  00018	e3a0a000	 mov         r10, #0
  0001c	e5933004	 ldr         r3, [r3, #4]
  00020	e5d33022	 ldrb        r3, [r3, #0x22]
  00024	e3530000	 cmp         r3, #0
  00028	1a00000b	 bne         |$LN19@OsInitOS|

; 189  : 	{
; 190  : 		/*
; 191  : 			See "Program Applications to Turn the Smartphone Backlight Off and On":
; 192  : 				<http://msdn.microsoft.com/library/default.asp?url=/library/en-us/mobilesdk5/html/mob5tskHowToProgramApplicationsToTurnSmartphoneBacklightOffOn.asp>
; 193  : 		*/
; 194  : 		SetPowerRequirement(_T("BKL1:"), D0, POWER_NAME, NULL, 0);

  0002c	e59f0428	 ldr         r0, [pc, #0x428]
  00030	e3a03000	 mov         r3, #0
  00034	e3a02001	 mov         r2, #1
  00038	e3a01000	 mov         r1, #0
  0003c	e58da000	 str         r10, [sp]
  00040	eb000000	 bl          SetPowerRequirement

; 195  : 
; 196  : 		/*
; 197  : 			It is also necessary to prevent the display driver entering
; 198  : 			power-saving mode.
; 199  : 
; 200  : 			The string used here is hard-coded. The following function can
; 201  : 			probably be used to enumerate available strings:
; 202  : 				RequestDeviceNotifications()
; 203  : 		*/
; 204  : 		SetPowerRequirement(_T("{EB91C7C9-8BF6-4a2d-9AB8-69724EED97D1}\\\\Windows\\ddi.dll"), D0, POWER_NAME, NULL, 0);

  00044	e59f040c	 ldr         r0, [pc, #0x40C]
  00048	e3a03000	 mov         r3, #0
  0004c	e3a02001	 mov         r2, #1
  00050	e3a01000	 mov         r1, #0
  00054	e58da000	 str         r10, [sp]
  00058	eb000000	 bl          SetPowerRequirement
  0005c		 |$LN19@OsInitOS|

; 205  :     }
; 206  : #endif
; 207  : 
; 208  : 	/*
; 209  : 		Build the window title
; 210  : 	*/
; 211  : 	{
; 212  : 		const char		*pszName, *pszSeparator, *pszVersion;
; 213  : 		size_t			len;
; 214  : 		unsigned int	out, in;
; 215  : 
; 216  : 		pszName			= (const char*)m_pShell->PVRShellGet(prefAppName);

  0005c	e5960040	 ldr         r0, [r6, #0x40]
  00060	e3a01000	 mov         r1, #0
  00064	eb000000	 bl          |?PVRShellGet@PVRShell@@QBAPBXW4prefNameConstPtrEnum@@@Z|
  00068	e1a08000	 mov         r8, r0

; 217  : 		pszSeparator	= STR_WNDTITLE;
; 218  : 		pszVersion		= (const char*)m_pShell->PVRShellGet(prefVersion);

  0006c	e5960040	 ldr         r0, [r6, #0x40]
  00070	e3a01006	 mov         r1, #6
  00074	eb000000	 bl          |?PVRShellGet@PVRShell@@QBAPBXW4prefNameConstPtrEnum@@@Z|
  00078	e1a07000	 mov         r7, r0

; 219  : 
; 220  : 		len = strlen(pszName)+strlen(pszSeparator)+strlen(pszVersion)+1;

  0007c	e1a00008	 mov         r0, r8
  00080	eb000000	 bl          strlen
  00084	e59f93c8	 ldr         r9, [pc, #0x3C8]
  00088	e1a05000	 mov         r5, r0
  0008c	e1a00009	 mov         r0, r9
  00090	eb000000	 bl          strlen
  00094	e1a04000	 mov         r4, r0
  00098	e1a00007	 mov         r0, r7
  0009c	eb000000	 bl          strlen
  000a0	e0803004	 add         r3, r0, r4
  000a4	e0833005	 add         r3, r3, r5
  000a8	e2833001	 add         r3, r3, #1

; 221  : 		appName = new TCHAR[len];

  000ac	e3730106	 cmn         r3, #6, 2
  000b0	91a00083	 movls       r0, r3, lsl #1
  000b4	83e00000	 mvnhi       r0, #0
  000b8	eb000000	 bl          |??2@YAPAXI@Z|

; 222  : 
; 223  : 		for(out = 0; appName[out] = pszName[out]; ++out);

  000bc	e1d830d0	 ldrsb       r3, [r8]
  000c0	e1a05000	 mov         r5, r0
  000c4	e3a02000	 mov         r2, #0
  000c8	e1a03803	 mov         r3, r3, lsl #16
  000cc	e1b03823	 movs        r3, r3, lsr #16
  000d0	e1c530b0	 strh        r3, [r5]
  000d4	0a000006	 beq         |$LN16@OsInitOS|

; 221  : 		appName = new TCHAR[len];

  000d8	e1a01005	 mov         r1, r5
  000dc		 |$LL18@OsInitOS|

; 222  : 
; 223  : 		for(out = 0; appName[out] = pszName[out]; ++out);

  000dc	e2822001	 add         r2, r2, #1
  000e0	e19230d8	 ldrsb       r3, [r2, +r8]
  000e4	e1a03803	 mov         r3, r3, lsl #16
  000e8	e1b03823	 movs        r3, r3, lsr #16
  000ec	e1e130b2	 strh        r3, [r1, #2]!
  000f0	1afffff9	 bne         |$LL18@OsInitOS|
  000f4		 |$LN16@OsInitOS|

; 224  : 		for(in = 0; appName[out] = pszSeparator[in]; ++in, ++out);

  000f4	e0851082	 add         r1, r5, r2, lsl #1
  000f8	e3a03020	 mov         r3, #0x20
  000fc	e1c130b0	 strh        r3, [r1]
  00100		 |$LL15@OsInitOS|
  00100	e1f930d1	 ldrsb       r3, [r9, #1]!
  00104	e2822001	 add         r2, r2, #1
  00108	e1a03803	 mov         r3, r3, lsl #16
  0010c	e1b03823	 movs        r3, r3, lsr #16
  00110	e1e130b2	 strh        r3, [r1, #2]!
  00114	1afffff9	 bne         |$LL15@OsInitOS|

; 225  : 		for(in = 0; appName[out] = pszVersion[in]; ++in, ++out);

  00118	e1d730d0	 ldrsb       r3, [r7]
  0011c	e0852082	 add         r2, r5, r2, lsl #1
  00120	e1a03803	 mov         r3, r3, lsl #16
  00124	e1b03823	 movs        r3, r3, lsr #16
  00128	e1c230b0	 strh        r3, [r2]
  0012c	0a000004	 beq         |$LN10@OsInitOS|
  00130		 |$LL12@OsInitOS|
  00130	e1f730d1	 ldrsb       r3, [r7, #1]!
  00134	e1a03803	 mov         r3, r3, lsl #16
  00138	e1b03823	 movs        r3, r3, lsr #16
  0013c	e1e230b2	 strh        r3, [r2, #2]!
  00140	1afffffa	 bne         |$LL12@OsInitOS|
  00144		 |$LN10@OsInitOS|

; 226  : 		_ASSERT(out == len-1);
; 227  : 	}
; 228  : 
; 229  : 	/*
; 230  : 		Retrieve the monitor information.
; 231  : 
; 232  : 		MonitorFromWindow() doesn't work, because the window hasn't been
; 233  : 		created yet.
; 234  : 	*/
; 235  : 	{
; 236  : 		HMONITOR	hMonitor;
; 237  : 		BOOL		bRet;
; 238  : 
; 239  : 		p.x			= m_pShell->m_pShellData->nShellPosX;

  00144	e5961040	 ldr         r1, [r6, #0x40]

; 240  : 		p.y			= m_pShell->m_pShellData->nShellPosY;
; 241  : 		hMonitor	= MonitorFromPoint(p, MONITOR_DEFAULTTOPRIMARY);

  00148	e3a02001	 mov         r2, #1
  0014c	e5913004	 ldr         r3, [r1, #4]
  00150	e5930010	 ldr         r0, [r3, #0x10]
  00154	e58d0020	 str         r0, [sp, #0x20]
  00158	e5913004	 ldr         r3, [r1, #4]
  0015c	e5931014	 ldr         r1, [r3, #0x14]
  00160	e58d1024	 str         r1, [sp, #0x24]
  00164	eb000000	 bl          MonitorFromPoint

; 242  : 		sMInfo.cbSize = sizeof(sMInfo);

  00168	e3a03028	 mov         r3, #0x28

; 243  : 		bRet = GetMonitorInfo(hMonitor, &sMInfo);

  0016c	e28d1038	 add         r1, sp, #0x38
  00170	e58d3038	 str         r3, [sp, #0x38]
  00174	eb000000	 bl          GetMonitorInfo
  00178		 |$LL9@OsInitOS|

; 244  : 		_ASSERT(bRet);
; 245  : 	}
; 246  : 
; 247  : 	/*
; 248  : 		Reduce the window size until it fits on screen
; 249  : 	*/
; 250  : 	while(
; 251  : 		(m_pShell->m_pShellData->nShellDimX > (sMInfo.rcMonitor.right - sMInfo.rcMonitor.left)) ||
; 252  : 		(m_pShell->m_pShellData->nShellDimY > (sMInfo.rcMonitor.bottom - sMInfo.rcMonitor.top)))

  00178	e596e040	 ldr         lr, [r6, #0x40]
  0017c	e59d2044	 ldr         r2, [sp, #0x44]
  00180	e59d303c	 ldr         r3, [sp, #0x3C]
  00184	e59e0004	 ldr         r0, [lr, #4]
  00188	e0422003	 sub         r2, r2, r3
  0018c	e5903008	 ldr         r3, [r0, #8]
  00190	e1530002	 cmp         r3, r2
  00194	ca000005	 bgt         |$LN7@OsInitOS|
  00198	e59d1048	 ldr         r1, [sp, #0x48]
  0019c	e59d3040	 ldr         r3, [sp, #0x40]
  001a0	e590200c	 ldr         r2, [r0, #0xC]
  001a4	e0413003	 sub         r3, r1, r3
  001a8	e1520003	 cmp         r2, r3
  001ac	da000009	 ble         |$LN8@OsInitOS|
  001b0		 |$LN7@OsInitOS|

; 253  : 	{
; 254  : 		m_pShell->m_pShellData->nShellDimX >>= 1;

  001b0	e59e2004	 ldr         r2, [lr, #4]
  001b4	e5923008	 ldr         r3, [r2, #8]
  001b8	e1a030c3	 mov         r3, r3, asr #1
  001bc	e5823008	 str         r3, [r2, #8]

; 255  : 		m_pShell->m_pShellData->nShellDimY >>= 1;

  001c0	e5963040	 ldr         r3, [r6, #0x40]
  001c4	e5932004	 ldr         r2, [r3, #4]
  001c8	e592300c	 ldr         r3, [r2, #0xC]
  001cc	e1a030c3	 mov         r3, r3, asr #1
  001d0	e582300c	 str         r3, [r2, #0xC]

; 256  : 	}

  001d4	eaffffe7	 b           |$LL9@OsInitOS|
  001d8		 |$LN8@OsInitOS|

; 257  : 
; 258  : 
; 259  : 	/*
; 260  : 		Create the window
; 261  : 	*/
; 262  : 
; 263  : 	if(m_pShell->m_pShellData->bFullScreen)

  001d8	e5962040	 ldr         r2, [r6, #0x40]
  001dc	e5923004	 ldr         r3, [r2, #4]
  001e0	e5d33018	 ldrb        r3, [r3, #0x18]
  001e4	e3530000	 cmp         r3, #0
  001e8	0a000011	 beq         |$LN6@OsInitOS|

; 264  : 	{
; 265  : 		m_hWnd = CreateWindow(WINDOW_CLASS, appName, WS_VISIBLE,
; 266  : 		   	0, 0, m_pShell->m_pShellData->nShellDimX, m_pShell->m_pShellData->nShellDimY, NULL, NULL, m_hInstance, this);

  001ec	e5923004	 ldr         r3, [r2, #4]
  001f0	e596e034	 ldr         lr, [r6, #0x34]
  001f4	e59f1254	 ldr         r1, [pc, #0x254]
  001f8	e593200c	 ldr         r2, [r3, #0xC]
  001fc	e5930008	 ldr         r0, [r3, #8]
  00200	e3a03201	 mov         r3, #1, 4
  00204	e58d200c	 str         r2, [sp, #0xC]
  00208	e58d0008	 str         r0, [sp, #8]
  0020c	e1a02005	 mov         r2, r5
  00210	e3a00000	 mov         r0, #0
  00214	e58d601c	 str         r6, [sp, #0x1C]
  00218	e58de018	 str         lr, [sp, #0x18]
  0021c	e58da014	 str         r10, [sp, #0x14]
  00220	e58da010	 str         r10, [sp, #0x10]
  00224	e58da004	 str         r10, [sp, #4]
  00228	e58da000	 str         r10, [sp]
  0022c	eb000000	 bl          CreateWindowExW

; 267  : 	}
; 268  : 	else

  00230	ea000039	 b           |$LN32@OsInitOS|
  00234		 |$LN6@OsInitOS|

; 269  : 	{
; 270  : 		int x, y;
; 271  : 
; 272  : 		SetRect(&winRect,
; 273  : 			m_pShell->m_pShellData->nShellPosX,
; 274  : 			m_pShell->m_pShellData->nShellPosY,
; 275  : 			m_pShell->m_pShellData->nShellPosX+m_pShell->m_pShellData->nShellDimX,
; 276  : 			m_pShell->m_pShellData->nShellPosY+m_pShell->m_pShellData->nShellDimY);

  00234	e592e004	 ldr         lr, [r2, #4]
  00238	e28d0028	 add         r0, sp, #0x28
  0023c	e59e2014	 ldr         r2, [lr, #0x14]
  00240	e59e300c	 ldr         r3, [lr, #0xC]
  00244	e59e1010	 ldr         r1, [lr, #0x10]
  00248	e59ee008	 ldr         lr, [lr, #8]
  0024c	e0823003	 add         r3, r2, r3
  00250	e58d3000	 str         r3, [sp]
  00254	e081300e	 add         r3, r1, lr
  00258	eb000000	 bl          SetRect

; 277  : 		AdjustWindowRectEx(&winRect, WS_CAPTION|WS_SYSMENU, false, 0);

  0025c	e3a03000	 mov         r3, #0
  00260	e3a02000	 mov         r2, #0
  00264	e3a01732	 mov         r1, #0x32, 14
  00268	e28d0028	 add         r0, sp, #0x28
  0026c	eb000000	 bl          AdjustWindowRectEx

; 278  : 
; 279  : 		x = m_pShell->m_pShellData->nShellPosX - winRect.left;

  00270	e5960040	 ldr         r0, [r6, #0x40]
  00274	e59d1028	 ldr         r1, [sp, #0x28]

; 280  : 		winRect.left += x;
; 281  : 		winRect.right += x;

  00278	e59d2030	 ldr         r2, [sp, #0x30]
  0027c	e5903004	 ldr         r3, [r0, #4]

; 282  : 
; 283  : 		y = m_pShell->m_pShellData->nShellPosY - winRect.top;
; 284  : 		winRect.top += y;
; 285  : 		winRect.bottom += y;
; 286  : 
; 287  : 		if(m_pShell->m_pShellData->bShellPosWasDefault)
; 288  : 		{
; 289  : 			x = CW_USEDEFAULT;
; 290  : 			y = CW_USEDEFAULT;
; 291  : 		}
; 292  : 		else
; 293  : 		{
; 294  : 			x = winRect.left;
; 295  : 			y = winRect.top;
; 296  : 		}
; 297  : 
; 298  : 		m_hWnd = CreateWindow(WINDOW_CLASS, appName, WS_VISIBLE|WS_CAPTION|WS_SYSMENU,
; 299  : 			x, y, winRect.right-winRect.left, winRect.bottom-winRect.top, NULL, NULL, m_hInstance, this);

  00280	e58d601c	 str         r6, [sp, #0x1C]
  00284	e58da014	 str         r10, [sp, #0x14]
  00288	e5933010	 ldr         r3, [r3, #0x10]
  0028c	e58da010	 str         r10, [sp, #0x10]
  00290	e0433001	 sub         r3, r3, r1
  00294	e0814003	 add         r4, r1, r3
  00298	e0829003	 add         r9, r2, r3
  0029c	e58d4028	 str         r4, [sp, #0x28]
  002a0	e58d9030	 str         r9, [sp, #0x30]
  002a4	e5903004	 ldr         r3, [r0, #4]
  002a8	e59d102c	 ldr         r1, [sp, #0x2C]
  002ac	e59d2034	 ldr         r2, [sp, #0x34]
  002b0	e5933014	 ldr         r3, [r3, #0x14]
  002b4	e0433001	 sub         r3, r3, r1
  002b8	e081e003	 add         lr, r1, r3
  002bc	e0822003	 add         r2, r2, r3
  002c0	e58de02c	 str         lr, [sp, #0x2C]
  002c4	e58d2034	 str         r2, [sp, #0x34]
  002c8	e5903004	 ldr         r3, [r0, #4]
  002cc	e59f117c	 ldr         r1, [pc, #0x17C]
  002d0	e3a00543	 mov         r0, #0x43, 10
  002d4	e5d33038	 ldrb        r3, [r3, #0x38]
  002d8	e3530000	 cmp         r3, #0
  002dc	e5963034	 ldr         r3, [r6, #0x34]
  002e0	13a07102	 movne       r7, #2, 2
  002e4	13a08102	 movne       r8, #2, 2
  002e8	e58d3018	 str         r3, [sp, #0x18]
  002ec	01a07004	 moveq       r7, r4
  002f0	01a0800e	 moveq       r8, lr
  002f4	e3803702	 orr         r3, r0, #2, 14
  002f8	e042e00e	 sub         lr, r2, lr
  002fc	e0494004	 sub         r4, r9, r4
  00300	e3a00000	 mov         r0, #0
  00304	e1a02005	 mov         r2, r5
  00308	e58de00c	 str         lr, [sp, #0xC]
  0030c	e58d4008	 str         r4, [sp, #8]
  00310	e58d8004	 str         r8, [sp, #4]
  00314	e58d7000	 str         r7, [sp]
  00318	eb000000	 bl          CreateWindowExW
  0031c		 |$LN32@OsInitOS|

; 300  : 	}
; 301  : 
; 302  : 	if(!m_hWnd)

  0031c	e1a03000	 mov         r3, r0
  00320	e5860020	 str         r0, [r6, #0x20]
  00324	e1b00003	 movs        r0, r3

; 303  : 		return false;

  00328	03a00000	 moveq       r0, #0
  0032c	0a000044	 beq         |$LN20@OsInitOS|

; 304  : 
; 305  : #ifdef UNDER_CE
; 306  : 	// For the Axim (X50v, X51v)
; 307  : 	RegisterHotKey(m_hWnd, 0xC1, MOD_WIN, 0xC1);

  00330	e3a030c1	 mov         r3, #0xC1
  00334	e3a02008	 mov         r2, #8
  00338	e3a010c1	 mov         r1, #0xC1
  0033c	eb000000	 bl          RegisterHotKey

; 308  : 	RegisterHotKey(m_hWnd, 0xC2, MOD_WIN, 0xC2);

  00340	e5960020	 ldr         r0, [r6, #0x20]
  00344	e3a030c2	 mov         r3, #0xC2
  00348	e3a02008	 mov         r2, #8
  0034c	e3a010c2	 mov         r1, #0xC2
  00350	eb000000	 bl          RegisterHotKey

; 309  : 	RegisterHotKey(m_hWnd, 0xC3, MOD_WIN, 0xC3);

  00354	e5960020	 ldr         r0, [r6, #0x20]
  00358	e3a030c3	 mov         r3, #0xC3
  0035c	e3a02008	 mov         r2, #8
  00360	e3a010c3	 mov         r1, #0xC3
  00364	eb000000	 bl          RegisterHotKey

; 310  : 	RegisterHotKey(m_hWnd, 0xC4, MOD_WIN, 0xC4);

  00368	e5960020	 ldr         r0, [r6, #0x20]
  0036c	e3a030c4	 mov         r3, #0xC4
  00370	e3a02008	 mov         r2, #8
  00374	e3a010c4	 mov         r1, #0xC4
  00378	eb000000	 bl          RegisterHotKey

; 311  : #endif
; 312  : 
; 313  : 	if(m_pShell->m_pShellData->bFullScreen)

  0037c	e5963040	 ldr         r3, [r6, #0x40]
  00380	e593e004	 ldr         lr, [r3, #4]
  00384	e5de3018	 ldrb        r3, [lr, #0x18]
  00388	e3530000	 cmp         r3, #0
  0038c	0a000011	 beq         |$LN1@OsInitOS|

; 314  : 	{
; 315  : 		m_pShell->m_pShellData->nShellDimX = sMInfo.rcMonitor.right;

  00390	e59d0044	 ldr         r0, [sp, #0x44]

; 316  : 		m_pShell->m_pShellData->nShellDimY = sMInfo.rcMonitor.bottom;
; 317  : 		SetWindowPos(m_hWnd,HWND_TOPMOST,0,0,m_pShell->m_pShellData->nShellDimX,m_pShell->m_pShellData->nShellDimY,0);

  00394	e3a03000	 mov         r3, #0
  00398	e3a02000	 mov         r2, #0
  0039c	e58e0008	 str         r0, [lr, #8]
  003a0	e5960040	 ldr         r0, [r6, #0x40]
  003a4	e59de048	 ldr         lr, [sp, #0x48]
  003a8	e3e01000	 mvn         r1, #0
  003ac	e5900004	 ldr         r0, [r0, #4]
  003b0	e58da008	 str         r10, [sp, #8]
  003b4	e580e00c	 str         lr, [r0, #0xC]
  003b8	e596e040	 ldr         lr, [r6, #0x40]
  003bc	e5960020	 ldr         r0, [r6, #0x20]
  003c0	e59ee004	 ldr         lr, [lr, #4]
  003c4	e59e400c	 ldr         r4, [lr, #0xC]
  003c8	e59ee008	 ldr         lr, [lr, #8]
  003cc	e58d4004	 str         r4, [sp, #4]
  003d0	e58de000	 str         lr, [sp]
  003d4	eb000000	 bl          SetWindowPos
  003d8		 |$LN1@OsInitOS|

; 318  : 
; 319  : #if UNDER_CE == 420 || defined(WIN32_PLATFORM_PSPC) || defined(WIN32_PLATFORM_WFSP)
; 320  : 		/*
; 321  : 			Fix for 'Top menu-bar' corruption (occurring on exiting egltest in
; 322  : 			fullscreen mode on PocketPC).
; 323  : 
; 324  : 			See "How To Create Full-Screen Applications for the PocketPC":
; 325  : 				<http://support.microsoft.com/default.aspx?scid=kb;%5Bln%5D;266244>
; 326  : 		*/
; 327  : 		SetForegroundWindow(m_hWnd);
; 328  : 		SHFullScreen(m_hWnd, SHFS_HIDETASKBAR | SHFS_HIDESIPBUTTON | SHFS_HIDESTARTICON);
; 329  : 		MoveWindow(m_hWnd,
; 330  : 					sMInfo.rcMonitor.left,
; 331  : 					sMInfo.rcMonitor.top,
; 332  : 					sMInfo.rcMonitor.right,
; 333  : 					sMInfo.rcMonitor.bottom,
; 334  : 					TRUE);
; 335  : #endif
; 336  : 	}
; 337  : 
; 338  : 	m_hDC = GetDC(m_hWnd);

  003d8	e5960020	 ldr         r0, [r6, #0x20]
  003dc	eb000000	 bl          GetDC

; 339  : 	ShowWindow(m_hWnd, m_nCmdShow);

  003e0	e5961038	 ldr         r1, [r6, #0x38]
  003e4	e1a03000	 mov         r3, r0
  003e8	e5960020	 ldr         r0, [r6, #0x20]
  003ec	e586301c	 str         r3, [r6, #0x1C]
  003f0	eb000000	 bl          ShowWindow

; 340  : 	UpdateWindow(m_hWnd);

  003f4	e5960020	 ldr         r0, [r6, #0x20]
  003f8	eb000000	 bl          UpdateWindow

; 341  : 
; 342  : 	p.x = 0;
; 343  : 	p.y = 0;
; 344  : 	ClientToScreen(m_hWnd, &p);

  003fc	e5960020	 ldr         r0, [r6, #0x20]
  00400	e3a03000	 mov         r3, #0
  00404	e3a02000	 mov         r2, #0
  00408	e28d1020	 add         r1, sp, #0x20
  0040c	e58d3020	 str         r3, [sp, #0x20]
  00410	e58d2024	 str         r2, [sp, #0x24]
  00414	eb000000	 bl          ClientToScreen

; 345  : 	m_pShell->m_pShellData->nShellPosX = p.x;

  00418	e5963040	 ldr         r3, [r6, #0x40]
  0041c	e59d2020	 ldr         r2, [sp, #0x20]

; 346  : 	m_pShell->m_pShellData->nShellPosY = p.y;
; 347  : 
; 348  : 	delete [] appName;

  00420	e1a00005	 mov         r0, r5
  00424	e5933004	 ldr         r3, [r3, #4]
  00428	e5832010	 str         r2, [r3, #0x10]
  0042c	e5963040	 ldr         r3, [r6, #0x40]
  00430	e59d2024	 ldr         r2, [sp, #0x24]
  00434	e5933004	 ldr         r3, [r3, #4]
  00438	e5832014	 str         r2, [r3, #0x14]
  0043c	eb000000	 bl          |??3@YAXPAX@Z|

; 349  : 	return true;

  00440	e3a00001	 mov         r0, #1
  00444		 |$LN20@OsInitOS|

; 350  : }

  00444	e28dd060	 add         sp, sp, #0x60
  00448	e8bd47f0	 ldmia       sp!, {r4 - r10, lr}
  0044c	e12fff1e	 bx          lr
  00450		 |$LN36@OsInitOS|
  00450		 |$LN37@OsInitOS|
  00450	00000000	 DCD         |??_C@_1BM@GPEKOMLI@?$AAP?$AAV?$AAR?$AAS?$AAh?$AAe?$AAl?$AAl?$AAC?$AAl?$AAa?$AAs?$AAs?$AA?$AA@|
  00454		 |$LN38@OsInitOS|
  00454	00000000	 DCD         |??_C@_09GOBDHBAA@?5?9?5Build?5?$AA@|
  00458		 |$LN39@OsInitOS|
  00458	00000000	 DCD         |??_C@_1HA@NLKMIAAA@?$AA?$HL?$AAE?$AAB?$AA9?$AA1?$AAC?$AA7?$AAC?$AA9?$AA?9?$AA8?$AAB?$AAF?$AA6?$AA?9?$AA4?$AAa?$AA2?$AAd?$AA?9?$AA9?$AAA?$AAB?$AA8?$AA?9?$AA6?$AA9?$AA7?$AA2?$AA4?$AAE?$AAE@|
  0045c		 |$LN40@OsInitOS|
  0045c	00000000	 DCD         |??_C@_1M@BAKKPHMH@?$AAB?$AAK?$AAL?$AA1?$AA?3?$AA?$AA@|
  00460		 |$M33765|

			 ENDP  ; |?OsInitOS@PVRShellInit@@QAA_NXZ|, PVRShellInit::OsInitOS

	END
