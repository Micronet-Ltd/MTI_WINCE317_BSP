<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PowerVR SDK</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<table width="100%">
  <tr>
    <td width="33%">
      <p align="left">&nbsp;<a href="http://www.imgtec.com"><img border="0" src="IMGLogo.jpg" width="200" height="30"></a></p>
    </td>
    <td width="33%">
      <p align="center"><font color="#808080" face="Arial" size="2">PowerVR Software Development Kit</a></font></p>
    </td>
    <td width="34%">
      <p align="right"><a href="http://www.powervr.com"><img border="0" src="PVRlogo.jpg" width="200" height="27"></a></p>
    </td>
  </tr>
</table>
<hr>
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>dynamicArray.h</h1><a href="dynamicArray_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*!***************************************************************************</span>
00002 <span class="comment"> @File          dynamicArray.h</span>
00003 <span class="comment"></span>
00004 <span class="comment"> @Brief         Expanding array template class. Allows appending and direct</span>
00005 <span class="comment">                access. Mixing access types should be approached with caution.</span>
00006 <span class="comment"></span>
00007 <span class="comment"> @Author        PowerVR</span>
00008 <span class="comment"></span>
00009 <span class="comment"> @Date          11/10/2007</span>
00010 <span class="comment"></span>
00011 <span class="comment"> @Copyright     Copyright 2007 by Imagination Technologies Limited.</span>
00012 <span class="comment">                All rights reserved. No part of this software, either</span>
00013 <span class="comment">                material or conceptual may be copied or distributed,</span>
00014 <span class="comment">                transmitted, transcribed, stored in a retrieval system</span>
00015 <span class="comment">                or translated into any human or computer language in any</span>
00016 <span class="comment">                form by any means, electronic, mechanical, manual or</span>
00017 <span class="comment">                other-wise, or disclosed to third parties without the</span>
00018 <span class="comment">                express written permission of Imagination Technologies</span>
00019 <span class="comment">                Limited, Unit 8, HomePark Industrial Estate,</span>
00020 <span class="comment">                King's Langley, Hertfordshire, WD4 8LZ, U.K.</span>
00021 <span class="comment"></span>
00022 <span class="comment"> @Platform      ANSI compatible</span>
00023 <span class="comment"></span>
00024 <span class="comment"> @Description   Expanding array template class. Allows appending and direct</span>
00025 <span class="comment">                access. Mixing access methods should be approached with caution.</span>
00026 <span class="comment"></span>
00027 <span class="comment"> $Revision: 1.11 $</span>
00028 <span class="comment">*****************************************************************************/</span>
00029 
00030 <span class="preprocessor">#ifndef DYNAMIC_ARRAY_H</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#define DYNAMIC_ARRAY_H</span>
00032 <span class="preprocessor"></span>
00033 <span class="preprocessor">#include "assert.h"</span>
00034 <span class="preprocessor">#include "../PVRTGlobal.h"</span>
00035 
00036 <span class="comment">/*!****************************************************************************</span>
00037 <span class="comment">Class</span>
00038 <span class="comment">******************************************************************************/</span>
00039 
00040 <span class="comment">/*!***************************************************************************</span>
00041 <span class="comment">* @Class dynamicArray</span>
00042 <span class="comment">* @Brief Expanding array template class.</span>
00043 <span class="comment">* @Description Expanding array template class.</span>
00044 <span class="comment">*****************************************************************************/</span>
00045 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
00046 <span class="keyword">class </span><a class="code" href="classdynamicArray.html">dynamicArray</a>
00047 {
00048 <span class="keyword">public</span>:
00049     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classdynamicArray.html#s0">c_i32DefaultSize</a> = 8;
<a name="l00050"></a><a class="code" href="classdynamicArray.html">00050</a>     <span class="comment">/*!***************************************************************************</span>
00051 <span class="comment">    @Function           dynamicArray</span>
00052 <span class="comment">    @Description        Blank constructor. Makes a default sized array.</span>
<a name="l00053"></a><a class="code" href="classdynamicArray.html#s0">00053</a> <span class="comment">    *****************************************************************************/</span>
00054     <a class="code" href="classdynamicArray.html#a0">dynamicArray</a>():
00055     m_i32Size(0),
00056         m_i32Capacity(c_i32DefaultSize)
00057     {
00058         m_pArray = <span class="keyword">new</span> T[c_i32DefaultSize];
<a name="l00059"></a><a class="code" href="classdynamicArray.html#a0">00059</a>     }
00060 
00061     <span class="comment">/*!***************************************************************************</span>
00062 <span class="comment">    @Function           dynamicArray</span>
00063 <span class="comment">    @Input              i32Size intial size of array</span>
00064 <span class="comment">    @Description        Constructor taking initial size of array in elements.</span>
00065 <span class="comment">    *****************************************************************************/</span>
00066     <a class="code" href="classdynamicArray.html#a0">dynamicArray</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i32Size):
00067     m_i32Size(0),
00068         m_i32Capacity(i32Size)
00069     {
00070         _ASSERT(i32Size!=0);
00071         m_pArray = <span class="keyword">new</span> T[i32Size];
<a name="l00072"></a><a class="code" href="classdynamicArray.html#a1">00072</a>     }
00073 
00074     <span class="comment">/*!***************************************************************************</span>
00075 <span class="comment">    @Function           dynamicArray</span>
00076 <span class="comment">    @Input              original    the other dynamic array</span>
00077 <span class="comment">    @Description        Copy constructor.</span>
00078 <span class="comment">    *****************************************************************************/</span>
00079     <a class="code" href="classdynamicArray.html#a0">dynamicArray</a>(<span class="keyword">const</span> <a class="code" href="classdynamicArray.html">dynamicArray</a>&amp; original):
00080     m_i32Size(original.m_i32Size),
00081         m_i32Capacity(original.m_i32Capacity)
00082     {
00083         m_pArray = <span class="keyword">new</span> T[m_i32Capacity];
00084         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;m_i32Size;i++)
00085         {
<a name="l00086"></a><a class="code" href="classdynamicArray.html#a2">00086</a>             m_pArray[i]=original.<a class="code" href="classdynamicArray.html#r2">m_pArray</a>[i];
00087         }
00088     }
00089 
00090     <span class="comment">/*!***************************************************************************</span>
00091 <span class="comment">    @Function           dynamicArray</span>
00092 <span class="comment">    @Input              pArray  an ordinary array</span>
00093 <span class="comment">    @Input              i32Size     number of elements passed</span>
00094 <span class="comment">    @Description        constructor from ordinary array.</span>
00095 <span class="comment">    *****************************************************************************/</span>
00096     <a class="code" href="classdynamicArray.html#a0">dynamicArray</a>(<span class="keyword">const</span> T* <span class="keyword">const</span> pArray, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i32Size):
00097     m_i32Size(i32Size),
00098         m_i32Capacity(i32Size)
00099     {
00100         m_pArray = <span class="keyword">new</span> T[i32Size];
00101         <span class="comment">// copy old values to new array</span>
00102         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;m_i32Size;i++)
00103         {
<a name="l00104"></a><a class="code" href="classdynamicArray.html#a3">00104</a>             m_pArray[i]=pArray[i];
00105         }
00106     }
00107 
00108     <span class="comment">/*!***************************************************************************</span>
00109 <span class="comment">    @Function           ~dynamicArray</span>
00110 <span class="comment">    @Description        Destructor.</span>
00111 <span class="comment">    *****************************************************************************/</span>
00112     <a class="code" href="classdynamicArray.html#a4">~dynamicArray</a>()
00113     {
00114         <span class="keywordflow">if</span>(m_pArray)
00115             <span class="keyword">delete</span>[](m_pArray);
00116     }
00117 
00118 
00119     <span class="comment">/*!***************************************************************************</span>
00120 <span class="comment">    @Function           append</span>
<a name="l00121"></a><a class="code" href="classdynamicArray.html#a4">00121</a> <span class="comment">    @Input              addT    The element to append</span>
00122 <span class="comment">    @Description        appends an element to the end of the array, expanding it</span>
00123 <span class="comment">    if necessary.</span>
00124 <span class="comment">    *****************************************************************************/</span>
00125     <span class="keywordtype">void</span> <a class="code" href="classdynamicArray.html#a5">append</a>(T addT)
00126     {
00127         <span class="keywordflow">if</span>(m_i32Size==m_i32Capacity)        <span class="comment">// should never be &gt;</span>
00128         {   <span class="comment">// expand array: expensive</span>
00129 
00130             m_i32Capacity*=2;   <span class="comment">// array doubles in size for each expansion</span>
00131             T *pDeadArray,*pNewArray = <span class="keyword">new</span> T[m_i32Capacity]; <span class="comment">// make new array</span>
00132 
00133             <span class="comment">// copy old values to new array</span>
00134             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;m_i32Size;i++)
<a name="l00135"></a><a class="code" href="classdynamicArray.html#a5">00135</a>             {
00136                 pNewArray[i]=m_pArray[i];
00137             }
00138 
00139 
00140             pDeadArray = m_pArray;
00141             m_pArray = pNewArray;
00142             <span class="keyword">delete</span>[](pDeadArray);
00143         }
00144         <span class="comment">// add new element to end of array</span>
00145 
00146         m_pArray[m_i32Size] = addT;
00147         m_i32Size++;
00148     }
00149 
00150     <span class="comment">/*!***************************************************************************</span>
00151 <span class="comment">    @Function           prepend</span>
00152 <span class="comment">    @Input              addT    The element to prepend</span>
00153 <span class="comment">    @Description        prepend an element to the beginning of the array, expanding</span>
00154 <span class="comment">    it if necessary.</span>
00155 <span class="comment">    *****************************************************************************/</span>
00156     <span class="keywordtype">void</span> <a class="code" href="classdynamicArray.html#a6">prepend</a>(T addT)
00157     {
00158         <span class="keywordflow">if</span>(m_i32Size==m_i32Capacity)
00159         {   <span class="comment">// expand array</span>
00160 
00161             m_i32Capacity*=2;   <span class="comment">// array doubles in size for each expansion</span>
00162             T *pDeadArray,*pNewArray = <span class="keyword">new</span> T[m_i32Capacity]; <span class="comment">// make new array</span>
00163 
00164             <span class="comment">// copy all leaving a space at the start</span>
00165             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;m_i32Size;i++)
00166             {
<a name="l00167"></a><a class="code" href="classdynamicArray.html#a6">00167</a>                 pNewArray[i+1]=m_pArray[i];
00168             }
00169 
00170             pDeadArray = m_pArray;
00171             m_pArray = pNewArray;
00172             <span class="keyword">delete</span>[](pDeadArray);
00173         }
00174         <span class="keywordflow">else</span>
00175         {
00176             <span class="comment">// copy all leaving a space at the start</span>
00177             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;m_i32Size;i++)
00178             {
00179                 m_pArray[i+1]=m_pArray[i];
00180             }
00181         }
00182         <span class="comment">// add new element to end of array</span>
00183         m_pArray[0] = addT;
00184         m_i32Size++;
00185     }
00186 
00187     <span class="comment">/*!***************************************************************************</span>
00188 <span class="comment">    @Function           =</span>
00189 <span class="comment">    @Input              other   The dynamic array needing copied</span>
00190 <span class="comment">    @Description        assignment operator.</span>
00191 <span class="comment">    *****************************************************************************/</span>
00192     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt;
00193         <a class="code" href="classdynamicArray.html">dynamicArray</a>&amp; <a class="code" href="classdynamicArray.html#a7">operator=</a>(<span class="keyword">const</span> <a class="code" href="classdynamicArray.html">dynamicArray&lt;T2&gt;</a>&amp; other)
00194     {
00195         <span class="keywordflow">if</span>(m_pArray)
00196             <span class="keyword">delete</span>[](m_pArray);
00197 
00198         m_pArray = <span class="keyword">new</span> T2[other.<a class="code" href="classdynamicArray.html#r1">m_i32Capacity</a>];
00199         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;other.<a class="code" href="classdynamicArray.html#r0">m_i32Size</a>;i++)
00200         {
00201             m_pArray[i]=other.<a class="code" href="classdynamicArray.html#r2">m_pArray</a>[i];
00202         }
00203         m_i32Capacity = other.<a class="code" href="classdynamicArray.html#r1">m_i32Capacity</a>;
00204         m_i32Size = other.<a class="code" href="classdynamicArray.html#r0">m_i32Size</a>;
<a name="l00205"></a><a class="code" href="classdynamicArray.html#a7">00205</a>         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00206     }
00207 
00208     <span class="comment">/*!***************************************************************************</span>
00209 <span class="comment">    @Function           []</span>
00210 <span class="comment">    @Input              i32Index    index of element in array</span>
00211 <span class="comment">    @Return             the element indexed</span>
00212 <span class="comment">    @Description        indexed access into array. Note that this has no error</span>
00213 <span class="comment">    checking whatsoever</span>
00214 <span class="comment">    *****************************************************************************/</span>
00215     T&amp; <a class="code" href="classdynamicArray.html#a8">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i32Index)
00216     {
00217         _ASSERT(i32Index&lt;m_i32Capacity);
00218         <span class="keywordflow">return</span> m_pArray[i32Index];
00219     }
00220 
00221     <span class="comment">/*!***************************************************************************</span>
00222 <span class="comment">    @Function           []</span>
00223 <span class="comment">    @Input              i32Index    index of element in array</span>
00224 <span class="comment">    @Return         the element indexed</span>
00225 <span class="comment">    @Description        indexed access into array. Note that this has no error</span>
00226 <span class="comment">    checking whatsoever</span>
00227 <span class="comment">    *****************************************************************************/</span>
<a name="l00228"></a><a class="code" href="classdynamicArray.html#a8">00228</a>     <span class="keyword">const</span> T&amp; <a class="code" href="classdynamicArray.html#a8">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i32Index)<span class="keyword"> const</span>
00229 <span class="keyword">    </span>{
00230         _ASSERT(i32Index&lt;m_i32Capacity);
00231         <span class="keywordflow">return</span> m_pArray[i32Index];
00232     }
00233 
00234     <span class="comment">/*!***************************************************************************</span>
00235 <span class="comment">    @Function           getSize</span>
00236 <span class="comment">    @Return         size of array</span>
00237 <span class="comment">    @Description        gives current size of array/number of elements</span>
00238 <span class="comment">    *****************************************************************************/</span>
00239     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classdynamicArray.html#a10">getSize</a>()<span class="keyword"> const</span>
00240 <span class="keyword">    </span>{
00241         <span class="keywordflow">return</span> m_i32Size;
<a name="l00242"></a><a class="code" href="classdynamicArray.html#a9">00242</a>     }
00243 
00244     <span class="comment">/*!***************************************************************************</span>
00245 <span class="comment">    @Function           getCapacity</span>
00246 <span class="comment">    @Return         capacity of array</span>
00247 <span class="comment">    @Description        gives current allocated size of array/number of elements</span>
00248 <span class="comment">    *****************************************************************************/</span>
00249     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classdynamicArray.html#a11">getCapacity</a>()<span class="keyword"> const</span>
00250 <span class="keyword">    </span>{
00251         <span class="keywordflow">return</span> m_i32Capacity;
00252     }
00253 
<a name="l00254"></a><a class="code" href="classdynamicArray.html#a10">00254</a>     <span class="comment">/*!***************************************************************************</span>
00255 <span class="comment">    @Function           expandToSize</span>
00256 <span class="comment">    @Input              i32Size new capacity of array</span>
00257 <span class="comment">    @Description        expands array to new capacity</span>
00258 <span class="comment">    *****************************************************************************/</span>
00259     <span class="keywordtype">void</span> <a class="code" href="classdynamicArray.html#a12">expandToSize</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i32Size)
00260     {
00261         <span class="keywordflow">if</span>(i32Size&lt;=m_i32Capacity)
00262             <span class="keywordflow">return</span>; <span class="comment">// nothing to be done</span>
00263 
00264         T *pDeadArray,*pNewArray = <span class="keyword">new</span> T[i32Size]; <span class="comment">// make new array</span>
<a name="l00265"></a><a class="code" href="classdynamicArray.html#a11">00265</a> 
00266         <span class="comment">// copy old values to new array</span>
00267         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;m_i32Size;i++)
00268         {
00269             pNewArray[i]=m_pArray[i];
00270         }
00271 
00272         m_i32Capacity=i32Size;
00273         pDeadArray = m_pArray;
00274         m_pArray = pNewArray;
00275         <span class="keyword">delete</span>[](pDeadArray);
<a name="l00276"></a><a class="code" href="classdynamicArray.html#a12">00276</a>     }
00277 
00278     <span class="comment">/*!***************************************************************************</span>
00279 <span class="comment">    @Function           bubbleSort</span>
00280 <span class="comment">    @Description        very basic sorting function for array. Requires &gt; operator</span>
00281 <span class="comment">                        to be defined.</span>
00282 <span class="comment">                        TODO: implement a better sorting algorithm</span>
00283 <span class="comment">    *****************************************************************************/</span>
00284     <span class="keywordtype">void</span> <a class="code" href="classdynamicArray.html#a13">bubbleSort</a>()
00285     {
00286         <span class="keywordtype">bool</span> bSwap;
00287         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;m_i32Size;++i)
00288         {
00289             bSwap=<span class="keyword">false</span>;
00290             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0;j&lt;m_i32Size-1;++j)
00291             {
00292                 <span class="keywordflow">if</span>(m_pArray[j]&gt;m_pArray[j+1])
00293                 {
00294                     PVRTswap(m_pArray[j],m_pArray[j+1]);
00295                     bSwap = <span class="keyword">true</span>;
00296                 }
00297             }
00298             <span class="keywordflow">if</span>(!bSwap)
00299                 <span class="keywordflow">return</span>;
00300         }
00301     }
<a name="l00302"></a><a class="code" href="classdynamicArray.html#a13">00302</a> 
00303     <span class="comment">/*!***************************************************************************</span>
00304 <span class="comment">    @Function           bubbleSort</span>
00305 <span class="comment">    @Description        very basic sorting function for array. Requires &gt; operator</span>
00306 <span class="comment">    to be defined.</span>
00307 <span class="comment">    use when T is a pointer so that the &gt; operator is called</span>
00308 <span class="comment">    on the actual type otherwise gets sorted by the pointer</span>
00309 <span class="comment">    addresses - not so useful requires &gt; operator to be defined</span>
00310 <span class="comment">    TODO: implement a better sorting algorithm</span>
00311 <span class="comment">    *****************************************************************************/</span>
00312     <span class="keywordtype">void</span> <a class="code" href="classdynamicArray.html#a14">bubbleSortPointers</a>()
00313     {
00314         <span class="keywordtype">bool</span> bSwap;
00315         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;m_i32Size;++i)
00316         {
00317             bSwap=<span class="keyword">false</span>;
00318             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;m_i32Size-1;++j)
00319             {
00320                 <span class="keywordflow">if</span>((*m_pArray[j])&gt;(*m_pArray[j+1]))
00321                 {
00322                     PVRTswap(m_pArray[j],m_pArray[j+1]);
00323                     bSwap = <span class="keyword">true</span>;
00324                 }
00325             }
00326             <span class="keywordflow">if</span>(!bSwap)
00327                 <span class="keywordflow">return</span>;
00328         }
00329     }
00330 
<a name="l00331"></a><a class="code" href="classdynamicArray.html#a14">00331</a> <span class="keyword">private</span>:
00332     <span class="keywordtype">int</span>     m_i32Size;              
00333     <span class="keywordtype">int</span>     m_i32Capacity;          
00334     T       *m_pArray;              
00335 };
00336 
00337 
00338 
00339 
00340 
00341 
00342 
00343 <span class="preprocessor">#endif // DYNAMIC_ARRAY_H</span>
00344 <span class="preprocessor"></span>
00345 <span class="comment">/*****************************************************************************</span>
00346 <span class="comment">End of file (dynamicArray.h)</span>
00347 <span class="comment">*****************************************************************************/</span>
</pre></div><br>
<br>
<P align=left><FONT size=2><STRONG><A 
   href="http://www.imgtec.com/powervr/insider/legal/index.asp">Copyright</A> © 
   1999-2008, Imagination Technologies Ltd.</STRONG></FONT></P>
<hr>
<address style="align: left;"><small><FONT color=f0f>
Generated by <a href="http://www.doxygen.org/index.html">DOXYGEN</a> 1.3.6</small></address>
</body>
</html>
