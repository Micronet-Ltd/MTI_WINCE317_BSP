<html>
<head>
<title>
Flash Error Management
</title>

<style type="text/css">

<!--
/*  TwinText Style (c) PTLogica 2002 - 2004  */

 
/* Body */
body{font-family:"Verdana", sans-serif;font-size: 8pt; }

/* Body (Chapter) */
body.Main{background: #FFFFFF;color: #000000;  margin: 0;       }

/*IE 5.5 */
li, table {  font-family: "Verdana", sans-serif; font-size: 8pt;  }

/* Project Title */
div.ProjectTitle {
	font-style: italic;
	font-size: 8pt;
	font-weight: normal;
	color: White;
	text-align: left;
	padding-bottom: 3px;
}

/* Chapter's Title */
h1{font-family:"Verdana", sans-serif;font-size: 14px;
font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0px;margin-bottom: 9px;    padding-top: 15px;  padding-bottom: 15px;  padding-left: 10px;  background-color: #006699;  color: White;
 border-bottom: 4px solid Black;}
 
/* Feedback */
div.Feedback {
 	font-style: italic;
	font-size: 8pt;
	font-weight: normal;
    text-align: right;
    margin: 0px;
    padding: 2px;
    background: #EFEFEF;
    position: relative; top: -10px; left: 0px;
} 

/* Common to all section text, including first section */
div.SectionText{margin-left: 10px;margin-right: 10px;margin-top: 10px;margin-bottom: 10px;   }

/* Contents or Summary */
h2{font-family:"Verdana", sans-serif;font-size: 11pt;font-weight: bold;text-align: left;margin-left: 5px;margin-right: 0pt;margin-top: 5pt;margin-bottom: 2pt;}

/* Table of Contents */
div.Toc{margin-top: 30px;margin-bottom: 30px;  border: 1px solid #CCCCCC;  padding: 5px;  margin-left: 30px;  margin-right: 30px;    }
div.TocLinks{font-weight: normal;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0pt;margin-bottom: 0pt;}
ul.TocLinks{}
li.TocLink{}
a.TocLink{}

/* Summary */
div.Summary{margin-top: 20px;margin-bottom: 40px;    padding: 5px;  margin-left: 30px;  margin-right: 20px; }
table.SummaryTable{  margin-top: 15px;  margin-bottom: 15px;  background-color: transparent;                   }
tr.SummaryRow { }
td.SummaryLink{font-weight: normal;text-align: left;width: 15%;        padding: 5px;             }
td.SummaryText{text-align: left;      padding: 5px;  background-color: transparent;  color: Black;                    }
a.SummaryLink{ }

/* Sections */
div.AllSections{margin-top: 0;margin-bottom: 70px;  margin-left: 0;  margin-right: 0;  }

div.Section{margin-top: 30px;margin-bottom: 10px;}
h3{font-family:"Verdana", sans-serif;font-size: 11pt;font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 5pt;margin-bottom: 10px;  padding-left: 10px;  padding-bottom: 3px;  background: #6699CC;  color: White;  border-bottom: 1px solid Black;     }

/* API Box */
div.Api{font-family:"Courier New", monospace;font-size: 9pt;margin-left: 15px;margin-right: 15px;margin-top: 15px;margin-bottom: 15px;padding: 7px;color: Black;  border: 1px solid #CCCCCC;  background: transparent;  }
font.ApiName{font-weight: bold;  background-color: transparent;  color: Black;  }

/* Section Text Elements */
h4{font-family:"Verdana", sans-serif;font-size: 9pt;font-weight: bold;margin-left: 0pt;margin-right: 0pt;margin-top: 5pt;margin-bottom: 2pt;}
pre{font-family:"Courier New", monospace;font-size: 11px;white-space: pre;margin-top: 7pt;margin-bottom: 7pt;  border: 1px dashed #CCCCCC;  padding: 5px;  margin-left: 5px;  margin-right: 5px;  color: Black;     }
font.HighText{ background-color: #FFFF00; color: Black;  font-weight: normal;}
ul{}
li{list-style: disc;}
a:link{text-decoration:none;color: #005499;background: transparent;}
a:visited{text-decoration:none;color: #005499;background: transparent;}
a:active{text-decoration:none;color: #005499;background: transparent;}
a:hover{text-decoration:underline;color: #005499;background: transparent;}
	
	/* Definitions Table */
table.DefTable{ margin-left: 20px;  margin-right: 20px;   }
tr.Def{  }
td.Def{font-family:"Courier New", monospace;font-size: 9pt;  font-weight: normal;   padding-left: 5px;  padding-right: 5px;      color: Black;  vertical-align: top;  white-space: nowrap;  text-align: left;            }
td.DefSep{font-family:"Courier New", monospace;font-size: 9pt;padding-right: 5pt;padding-left: 5pt;  vertical-align: top;  text-align: center;  }
td.DefText{ vertical-align: top;  text-align: left;  }

/* Copyright */
div.Copy { padding: 10px;  }

/* Footer */
div.Footer{ border-top: 1px solid #CCCCCC;  margin-top: 10px;  padding: 5px;  border-bottom: 1px solid #CCCCCC;    }

div.SourceLocation{background: transparent;color: rgb(130,130,130);  font-size: 8pt;  margin-bottom: 10px;  margin-left: 10px;   }
div.LastGenerated{background: transparent;color: rgb(130,130,130);  font-size: 8pt;  margin-left: 40px;  }


/* Navigation */
body.Side{background: #6699CC;color: White;  margin: 0px;  padding: 0px;  }
div.Side{}
/* not well supported in some versions of IE; remove background color and bottom border */
/*div.SideTitle{font-family:"Verdana", sans-serif;font-size: 14px;color: White;font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0px;margin-bottom: 0px;  background-color: #006699;  padding-top: 15px;  padding-bottom: 15px;  padding-left: 5px;  border-bottom: 4px solid Black;} */
div.SideTitle{font-family:"Verdana", sans-serif;font-size: 14px;color: #000000;font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0px;margin-bottom: 0px;  padding-top: 15px;  padding-bottom: 15px;  padding-left: 7px; }
div.SideText{text-align: left;margin-top: 0px;margin-bottom: 5px;  margin-left: 0px;  margin-right: 0px;  padding-bottom: 9px;    padding-left: 7px;  color: #FFCC00;  background: #6699CC;  padding-top: 10px;  font-weight: bold;               }
div.SideDetail { font-family: Arial, serif;  font-size: 10pt;  font-weight: normal;  background: transparent;    margin: 0px;  background-color: transparent;  padding-top: 1px;  color: White;                              }
ul.SideDetail{     }
li.SideDetail{ white-space: nowrap;  list-style: square;        }
a.SideDetail:link { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 12px; font-weight: bold; }
a.SideDetail:visited { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 12px; font-weight: bold; }
a.SideDetail:hover { text-decoration: underline; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 12px; font-weight: bold; }
table.LinksTable{margin-top: 10px;margin-bottom: 10px; padding-left: 7px;      }
tr.SideLink{}
td.SideLink{}
a.SideLink:link { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 11px; }
a.SideLink:visited { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 11px; }
a.SideLink:hover { text-decoration: underline; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 11px; }







-->

</style>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="TwinText">

</head>
<body class=Main>
<h1>
Flash Error Management
</h1>
<div class=Feedback><a href="mailto:support@datalight.com?subject=Documentation Feedback: FlashFX Tera SDK for Microsoft Windows CE -- v2.1.1 Build 2128DF (Win32 Host): Flash Error Management">Send comments on this topic.</a></div>
<div class=SectionText>

        <h4>General Concepts</h4>

<p>        The introduction of MLC NAND flash devices injects the possibility that
        multi-bit errors could be seen as part of normal device operation.
        Further, the existence of bit errors is not necessarily indicative of
        imminent block failure, requiring immediate action. Finally, the rate
        at which bit errors occur and how severe an error consisting of a given
        number of bits really is will vary from device to device.

<p>        These facts lead to the requirement that some mechanism must be
        provided for gathering flash errors and providing general
        recommendations about what to do with them.

<p>        The purpose of the Error Manager is to satisfy this need. It
        provides for management of errors that occur within FlashFX Tera, that
        are related to the flash technology in use. Error states managed shall
        be limited only to those that can be caused by or are otherwise related
        to the Flash silicon technology in use; such errors will be referred to
        in this section as Flash Errors. In particular, runtime or
        configuration errors are not the focus of the Error Manager, and
        shall not be managed by the Error Manager.

<p>        It is conceivable that customers may wish to customize product
        responses to some error conditions; to that end, the function
        <a HREF=QF945_ErrorManager.c.htm#FfxErrorMgrPolicyHook>FfxErrorMgrPolicyHook()</a> may be modified if necessary.
        <b>However, prior to changing the Error Manager behavior, consulation with Datalight support is strongly recommended.</b>

<p>        <h4>Flash Errors</h4>

<p>        Flash Errors are comprised of the following conditions.

<p>        <b>Write Failure</b>

<p>        An attempted write has not completed successfully because status
        indications from the device indicate that a write error state exists.
        This usually occurs because a bit or bits within a page have failed to
        program and the block that contains the page in question needs to be
        retired.

<p>        <b>Erase Failure</b>

<p>        An attempted erase operation has not completed successfully because
        status indications from the device indicate an erase failure state
        exists. As with Write Failure, this is usually an indication that the
        block contains a bit or bits that did not erase successfully, and is an
        indicator that the block is due for retirement.

<p>        <b>Read Failure</b>

<p>        An attempted read operation has not completed successfully because
        status indications from the device indicate a read failure state
        exists. This error condition will not be seen with standard flash; it
        may only be seen with certain controllers that have reason to and are
        capable of flagging an error that occurs during a read and that does
        not involve data correction.

<p>        <b>Timeout</b>

<p>        A requested operation has timed out. This is usually indicative of a
        failure of the controller hardware or design rather than the flash
        device itself.

<p>        <b>Correctable ECC Fault</b>

<p>        A read operation is indicating that a correctable ECC fault has
        occurred, and the data read has been corrected.

<p>        <b>Uncorrectable ECC Fault</b>

<p>        A read operation is indicating that an uncorrectable bit error has
        occurred, and the data read is incorrect.

<p>        <b>Readback Verify Fault (if supported)</b>

<p>        Readback-Verify is a feature supported in some configurations of
        FlashFX Tera in which a data write is immediately followed by a read of
        the same data and the data read is compared to the original data
        provided to the write operation. If this comparison fails, a Readback
        Verify fault is indicated.

<p>        The SDK contains an enumeration, FFX_FLASHERROR, that encapsulates
        these conditions. This enumeration may be used by both clients and by
        custom error policy hooks. See the file "errmanager.h" in the FlashFX
        include directory.

<p>        <h4>Error Policy</h4>

<p>        For each error reported by the Device Manager, the Error Manager
        generates a Policy Recommendation as described below, that depends on
        the reported error type and any other factors that may be taken into
        account by the Policy Hook (described below).

<p>        <b>Policy Recommendations</b>

<p>        <ul>
<li>No Action
</ul>
        Depending on the variety of flash in use, and the nature of the
        reported error, it may not be necessary to take any action at all. In
        particular, with newer MLC NAND flash, as geometries get smaller and
        densities get higher, some baseline error rate can be expected that
        does not indicate abnormalities in the physical flash that requires
        specific attention. This policy recommendation is to indicate this
        condition.

<p>        <ul>
<li>Scrub Block Later
</ul>
        If history of error rate indicates that the charge storing data in a
        block is beginning to degrade, but that there is no reason to believe
        that the block is wearing out, it may be desirable to tell the
        application that a block may need to be scrubbed soon, but not
        necessarily now. Because this particular recommendation cannot be made
        without consulting an error rate history, this recommendation will
        never be made when using the default Error Manager configuration, which
        does not maintain error history.

<p>        <ul>
<li>Relocate Page Data
</ul>
        If the severity of an error is enough that the Error Manager has reason
        to believe that a page may soon fail to reliably store data (i.e. a
        read, write or cosmic ray disturbance has occurred), the Flash Error
        Manager may recommend that the page of data in question be immediately
        relocated. In systems where error history is maintained through a
        customized Policy Hook, this recommendation shall be construed to
        encompass the Scrub Block Later policy recommendation.

<p>        <ul>
<li>Scrub Block Now
</ul>
        If the nature of an error is such that the Error Manager has reason to
        believe that uncorrectable errors in stored data may imminently occur,
        the Error Manager may recommend that the block in use be immediately
        scrubbed. This policy recommendation is for that purpose.

<p>        <ul>
<li>Retire Block
</ul>
        If the Error Manager makes the determination that a block is no longer
        usable, it may recommend that the block be retired . This policy
        recommendation is for that purpose.

<p>        <ul>
<li>Abandon Operations
</ul>
        This Policy Recommendation is made by the Error Manager if it has
        detected a situation in which further processing is either not possible
        or is running the danger of irrevocably corrupting a flash device. It
        is typically generated only when the policy detects errors that
        indicate hardware failure or software conditions indicative of improper
        operation.

<p>        <ul>
<li>No Recommendation
</ul>
        This policy indicates that insufficient information is available to
        make a sensible recommendation. This is typified by situations where it
        is questionable whether the hardware or software of the system in which
        the Error Manager is operating is functioning per design.

<p>        <b>Important note about Recommendations</b>

<p>        It is important to note that these are recommended actions only. The
        client is free to use this recommendation as is or override it,
        depending on the factors it has to consider. The Error Manager does not
        implement actions based on the recommendations, it merely makes the
        recommendation.

<p>        <h4>Policy Hook</h4>

<p>        The Error Manager contains a default implementation that generates
        policy in a configurable hook. See the file
        \fmsl\devmgr\errpolicyhook.c. In this default implementation, there is
        only basic error management implemented. Additional error management
        capability may be implemented by customers at their discretion.

<p>        The default Policy Hook does not maintain or consult any flash device
        usage history. No memory is used, and all policy recommendations are
        necessarily based on the currently reported error. Because of this, the
        default hook won't generate the recommendations of "ScrubLater" or
        "RelocatePage, as described above. Customer implementations of the
        Policy Hook may generate these recommendations, but some customization
        of the FlashFX Tera Device Manager may be necessary.
        <b>It is strongly recommended that Datalight support be consulted before making any such changes.</b>

<p>        All data that is fed into the Error Manager is fed into the Policy
        Hook, including requested read, write or block erase operations. The
        default implementation does not use all of this data, but it is
        provided in the case that a customer implementation of the Policy Hook
        may use it.

<p>        The Error Manager in its default configuration makes no provision for
        error status or history to be preserved across an interruption. As a
        general rule, the implementation of the Policy Hook shouldn't attempt
        to save data to the flash device that is being managed, as this could
        lead to deadlock conditions or possibly corrupt the data contained on
        the flash device.

<p>        <h4>Error Manager services</h4>

<p>        Before discussing services, it is important to understand that the
        Error Manager uses the standard status reporting mechanism as a
        container for its data. As such, the API discussions below make many
        references the <a HREF=QF660_Structures.c.htm#FFXIOSTATUS>FFXIOSTATUS</a> type, which is that container.

<p>        The Error Manager makes the following services available, which are
        prototyped in errmanager.h.
        <ul>
<li><a HREF=QF945_ErrorManager.c.htm#FfxErrMgrEncodeCorrectedBits>FfxErrMgrEncodeCorrectedBits()</a>
        <li><a HREF=QF945_ErrorManager.c.htm#FfxErrMgrDecodeCorrectedBits>FfxErrMgrDecodeCorrectedBits()</a>
</ul>

                                                                                                    
</div>
<div class=AllSections>
</div>
<div class=Copy>Datalight FlashFX Tera SDK for Microsoft Windows CE<br>Copyright &#169; 1993-2012 Datalight, Inc.  All Rights Reserved Worldwide.</div>
</body>
</html>

