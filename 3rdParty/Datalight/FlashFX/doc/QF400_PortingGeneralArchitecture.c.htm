<html>
<head>
<title>
Porting Guide: General Architectural Overview
</title>

<style type="text/css">

<!--
/*  TwinText Style (c) PTLogica 2002 - 2004  */

 
/* Body */
body{font-family:"Verdana", sans-serif;font-size: 8pt; }

/* Body (Chapter) */
body.Main{background: #FFFFFF;color: #000000;  margin: 0;       }

/*IE 5.5 */
li, table {  font-family: "Verdana", sans-serif; font-size: 8pt;  }

/* Project Title */
div.ProjectTitle {
	font-style: italic;
	font-size: 8pt;
	font-weight: normal;
	color: White;
	text-align: left;
	padding-bottom: 3px;
}

/* Chapter's Title */
h1{font-family:"Verdana", sans-serif;font-size: 14px;
font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0px;margin-bottom: 9px;    padding-top: 15px;  padding-bottom: 15px;  padding-left: 10px;  background-color: #006699;  color: White;
 border-bottom: 4px solid Black;}
 
/* Feedback */
div.Feedback {
 	font-style: italic;
	font-size: 8pt;
	font-weight: normal;
    text-align: right;
    margin: 0px;
    padding: 2px;
    background: #EFEFEF;
    position: relative; top: -10px; left: 0px;
} 

/* Common to all section text, including first section */
div.SectionText{margin-left: 10px;margin-right: 10px;margin-top: 10px;margin-bottom: 10px;   }

/* Contents or Summary */
h2{font-family:"Verdana", sans-serif;font-size: 11pt;font-weight: bold;text-align: left;margin-left: 5px;margin-right: 0pt;margin-top: 5pt;margin-bottom: 2pt;}

/* Table of Contents */
div.Toc{margin-top: 30px;margin-bottom: 30px;  border: 1px solid #CCCCCC;  padding: 5px;  margin-left: 30px;  margin-right: 30px;    }
div.TocLinks{font-weight: normal;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0pt;margin-bottom: 0pt;}
ul.TocLinks{}
li.TocLink{}
a.TocLink{}

/* Summary */
div.Summary{margin-top: 20px;margin-bottom: 40px;    padding: 5px;  margin-left: 30px;  margin-right: 20px; }
table.SummaryTable{  margin-top: 15px;  margin-bottom: 15px;  background-color: transparent;                   }
tr.SummaryRow { }
td.SummaryLink{font-weight: normal;text-align: left;width: 15%;        padding: 5px;             }
td.SummaryText{text-align: left;      padding: 5px;  background-color: transparent;  color: Black;                    }
a.SummaryLink{ }

/* Sections */
div.AllSections{margin-top: 0;margin-bottom: 70px;  margin-left: 0;  margin-right: 0;  }

div.Section{margin-top: 30px;margin-bottom: 10px;}
h3{font-family:"Verdana", sans-serif;font-size: 11pt;font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 5pt;margin-bottom: 10px;  padding-left: 10px;  padding-bottom: 3px;  background: #6699CC;  color: White;  border-bottom: 1px solid Black;     }

/* API Box */
div.Api{font-family:"Courier New", monospace;font-size: 9pt;margin-left: 15px;margin-right: 15px;margin-top: 15px;margin-bottom: 15px;padding: 7px;color: Black;  border: 1px solid #CCCCCC;  background: transparent;  }
font.ApiName{font-weight: bold;  background-color: transparent;  color: Black;  }

/* Section Text Elements */
h4{font-family:"Verdana", sans-serif;font-size: 9pt;font-weight: bold;margin-left: 0pt;margin-right: 0pt;margin-top: 5pt;margin-bottom: 2pt;}
pre{font-family:"Courier New", monospace;font-size: 11px;white-space: pre;margin-top: 7pt;margin-bottom: 7pt;  border: 1px dashed #CCCCCC;  padding: 5px;  margin-left: 5px;  margin-right: 5px;  color: Black;     }
font.HighText{ background-color: #FFFF00; color: Black;  font-weight: normal;}
ul{}
li{list-style: disc;}
a:link{text-decoration:none;color: #005499;background: transparent;}
a:visited{text-decoration:none;color: #005499;background: transparent;}
a:active{text-decoration:none;color: #005499;background: transparent;}
a:hover{text-decoration:underline;color: #005499;background: transparent;}
	
	/* Definitions Table */
table.DefTable{ margin-left: 20px;  margin-right: 20px;   }
tr.Def{  }
td.Def{font-family:"Courier New", monospace;font-size: 9pt;  font-weight: normal;   padding-left: 5px;  padding-right: 5px;      color: Black;  vertical-align: top;  white-space: nowrap;  text-align: left;            }
td.DefSep{font-family:"Courier New", monospace;font-size: 9pt;padding-right: 5pt;padding-left: 5pt;  vertical-align: top;  text-align: center;  }
td.DefText{ vertical-align: top;  text-align: left;  }

/* Copyright */
div.Copy { padding: 10px;  }

/* Footer */
div.Footer{ border-top: 1px solid #CCCCCC;  margin-top: 10px;  padding: 5px;  border-bottom: 1px solid #CCCCCC;    }

div.SourceLocation{background: transparent;color: rgb(130,130,130);  font-size: 8pt;  margin-bottom: 10px;  margin-left: 10px;   }
div.LastGenerated{background: transparent;color: rgb(130,130,130);  font-size: 8pt;  margin-left: 40px;  }


/* Navigation */
body.Side{background: #6699CC;color: White;  margin: 0px;  padding: 0px;  }
div.Side{}
/* not well supported in some versions of IE; remove background color and bottom border */
/*div.SideTitle{font-family:"Verdana", sans-serif;font-size: 14px;color: White;font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0px;margin-bottom: 0px;  background-color: #006699;  padding-top: 15px;  padding-bottom: 15px;  padding-left: 5px;  border-bottom: 4px solid Black;} */
div.SideTitle{font-family:"Verdana", sans-serif;font-size: 14px;color: #000000;font-weight: bold;text-align: left;margin-left: 0pt;margin-right: 0pt;margin-top: 0px;margin-bottom: 0px;  padding-top: 15px;  padding-bottom: 15px;  padding-left: 7px; }
div.SideText{text-align: left;margin-top: 0px;margin-bottom: 5px;  margin-left: 0px;  margin-right: 0px;  padding-bottom: 9px;    padding-left: 7px;  color: #FFCC00;  background: #6699CC;  padding-top: 10px;  font-weight: bold;               }
div.SideDetail { font-family: Arial, serif;  font-size: 10pt;  font-weight: normal;  background: transparent;    margin: 0px;  background-color: transparent;  padding-top: 1px;  color: White;                              }
ul.SideDetail{     }
li.SideDetail{ white-space: nowrap;  list-style: square;        }
a.SideDetail:link { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 12px; font-weight: bold; }
a.SideDetail:visited { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 12px; font-weight: bold; }
a.SideDetail:hover { text-decoration: underline; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 12px; font-weight: bold; }
table.LinksTable{margin-top: 10px;margin-bottom: 10px; padding-left: 7px;      }
tr.SideLink{}
td.SideLink{}
a.SideLink:link { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 11px; }
a.SideLink:visited { text-decoration: none; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 11px; }
a.SideLink:hover { text-decoration: underline; color: #ffffff; font-family: Verdana, Arial, sans-serif; font-size: 11px; }







-->

</style>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="TwinText">

</head>
<body class=Main>
<h1>
Porting Guide: General Architectural Overview
</h1>
<div class=Feedback><a href="mailto:support@datalight.com?subject=Documentation Feedback: FlashFX Tera SDK for Microsoft Windows CE -- v2.1.1 Build 2128DF (Win32 Host): Porting Guide: General Architectural Overview">Send comments on this topic.</a></div>
<div class=SectionText>

        <h4>Ports and Projects</h4>

<p>        Throughout this manual the terms <font class=HighText>"port"</font> and <font class=HighText>"project"</font> are used
        frequently, and it is important to understand that they mean very
        different things.

<p>        A port is an implementation of FlashFX Tera for a specific operating
        environment. It consists of an OS Layer directory structure, which
        includes everything necessary to build a device driver for a given
        operating environment, as well as functions to provide an abstract
        interface to the operating environment for FlashFX to use.

<p>        A project is a specific customization of a port for a particular target
        hardware platform. A project cannot be implemented until after the port
        (the OS Layer) for a given operating environment has been completed. An
        unlimited number of projects may be based on any given port. A project
        is always specific to a given port. The FlashFX "projects" directory
        tree may contain multiple existing projects, as well as new projects
        you create. The directory in which a given project is implemented is
        referred to as the <font class=HighText>"Project Directory"</font>.

<p>        As described earlier, the FlashFX product family includes a number
        of SDKs for specific operating environments. The RTOS Porting Kit is
        designed for those users who need to create a new OS Layer for some
        environment that FlashFX does not inherently support. Part of the
        process for creating an OS Layer is defining what a given project looks
        like for that OS. Once the port to the new OS Layer is completed, one or
        more projects can be created from the port.

<p>        <h4>Design Goals</h4>

<p>        FlashFX Tera is designed with a unique architecture to achieve the
        following goals:
        <ul>
<li>The FlashFX core must be 100% ANSI C.
        <li>FlashFX must be fully portable to a wide variety of development environments and tools with minimal effort.
        <li>FlashFX must be able to take advantage of operating environment and CPU specific features, without compromising the portability of the core.
        <li>A developer implementing a port to a new operating system must be able to do so without modifying the core FlashFX code.
        <li>A developer implementing a project for an existing port must be able to do so without modifying any code except that in his Project Directory.
</ul>
        These goals are accomplished by abstraction at several different levels.

<p>        <b>The ToolSet Abstraction</b>

<p>        The entire FlashFX build process is abstracted using a concept
        called a ToolSet. A ToolSet is simply a Datalight defined set of build
        processes that allow a wide variety of development tools to be plugged
        into the FlashFX build process. The ToolSet concept is detailed in
        the Datalight Common Libraries (DCL) Reference in section Creating a
        New ToolSet.

<p>        <b>The OS Abstraction</b>

<p>        The OS abstraction is the software which manages the communication
        between FlashFX and the operating system.  This goes both directions.
        <ul>
<li>The operating system communicates with FlashFX via the block device driver interface.
        <li>FlashFX uses operating system features via the OS Services abstraction.
</ul>
        <b>The Project</b>

<p>        The project abstraction allows a FlashFX developer to configure the
        vast majority of FlashFX options without having to modify anything
        outside the Project Directory. This primarily consists of making
        changes to the file <a HREF=QF640_Headers.c.htm#ffxconf.h>ffxconf.h</a>. The project abstraction includes the
        ability to override certain functions in the OS Services Layer as well
        as the FlashFX Hooks Layer so that the project can be customized as
        required for a particular piece of target hardware.

<p>        <b>FlashFX Tera Coding Practices</b>

<p>        By properly implementing and using the abstractions described above,
        FlashFX as a whole is able to abide by the following rules:
        <ul>
<li>The code adheres to the ANSI X3.159-1989, or the "C89" standard.
        <li>Only code within the OS Layer can directly call operating system functions.
        <li>Only code within the CPU and OS Layer trees can include/use assembly language.
        <li>Only code within the OS Layer can call the CPU level API functions.
        <li>One and only one MAKE file is necessary for each directory in the FlashFX tree.
        <li>Standard ANSI C library functions are usable throughout the FlashFX project, however to maintain a small footprint (and to avoid reentrancy issues), things such as printf should be avoided. FlashFX includes an internal <a HREF=UD750_CLibrary.c.htm#DclPrintf>DclPrintf()</a> function. Generally the FlashFX core only uses the various str* and mem* functions from the standard C library.
        <li>Code outside the OS Layer tree cannot directly include operating system specific header files. For example, when doing Windows CE development, code in VBF cannot include windows.h. The build process itself is designed to limit the include path to enforce this rule.
</ul>
        <b>CPU Dependent Code</b>

<p>        While the core of FlashFX is written in ANSI C, FlashFX does have the
        ability to include CPU specific assembly language code when necessary.
        This code must reside either in the CPU or OS Layer trees within the
        FlashFX directory structure. The CPU-level API functions should only be
        called by code within the OS Layer. This ensures that the FlashFX core
        remains portable and fully independent from the hardware.

<p>        <b>About FlashFX Tera Code</b>

<p>        Most standard C-library functions should not be used because you are
        developing a system-level driver. If a boot loader or BIOS extension is
        used, the operating system call may not be available yet, or the
        operating system may not be reentrant.

<p>        <b>Debug Levels</b>

<p>        The symbol <a HREF=UD690_PreprocSymbols.c.htm#D_DEBUG>D_DEBUG</a> must always be defined when building FlashFX
        code. The symbol is typically set to a value ranging from 0 to 3, where
        0 indicates a release build of FlashFX.

<p>        <b>Assertion and Error Conditions</b>

<p>        The <a HREF=UD750_DebugFuncs.c.htm#DclAssert>DclAssert()</a>, <a HREF=UD750_DebugFuncs.c.htm#DclError>DclError()</a>, <a HREF=UD750_DebugFuncs.c.htm#DclProductionAssert>DclProductionAssert()</a>, and
        <a HREF=UD750_DebugFuncs.c.htm#DclProductionError>DclProductionError()</a> macros can be used during debugging and
        development to help identify problems. For example, these macros may be
        called in the case of a divide-by-zero or an attempt to access memory
        that has not been initialized. <a HREF=UD750_DebugFuncs.c.htm#DclAssert>DclAssert()</a> and <a HREF=UD750_DebugFuncs.c.htm#DclProductionAssert>DclProductionAssert()</a>
        test the condition passed to them and, if it fails, calls the back-end
        internal assert function.  <a HREF=UD750_DebugFuncs.c.htm#DclError>DclError()</a> and <a HREF=UD750_DebugFuncs.c.htm#DclProductionError>DclProductionError()</a> call the
        back-end assert function immediately without any conditional test.

<p>        <a HREF=UD750_DebugFuncs.c.htm#DclAssert>DclAssert()</a> and <a HREF=UD750_DebugFuncs.c.htm#DclError>DclError()</a> macros will be compiled into the code if the
        <a HREF=UD690_PreprocSymbols.c.htm#D_DEBUG>D_DEBUG</a> level is equal to or greater than 1. These statements will not
        be compiled in a non-debug build. <a HREF=UD750_DebugFuncs.c.htm#DclProductionAssert>DclProductionAssert()</a> and
        <a HREF=UD750_DebugFuncs.c.htm#DclProductionError>DclProductionError()</a> are always compiled.

<p>        <b>Displaying Messages</b>

<p>        <a HREF=UD750_CLibrary.c.htm#DclPrintf>DclPrintf()</a> can be used to display messages to the user. FFXPRINTF is
        used to display messages when using a debug version of FlashFX.
        Both these functions display the text using the <a HREF=UD750_Console.c.htm#DclOutputString>DclOutputString()</a>
        function.

<p>
                                                                                                    
</div>
<div class=AllSections>
</div>
<div class=Copy>Datalight FlashFX Tera SDK for Microsoft Windows CE<br>Copyright &#169; 1993-2012 Datalight, Inc.  All Rights Reserved Worldwide.</div>
</body>
</html>

