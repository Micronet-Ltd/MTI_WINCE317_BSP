#----------------------------------------------------------------------------
#				Description
#
#	This make file provides	the ToolSet specific make settings used
#	throughout the project.
#----------------------------------------------------------------------------

#----------------------------------------------------------------------------
#				Revision History
#	$Log: toolset.mak $
#	Revision 1.3  2009/02/07 23:27:18Z  garyp
#	Replaced the B_COPTION flag with B_CFLAGS and B_LOCALCFLAGS.
#	Revision 1.2  2006/12/06 23:55:31Z  Garyp
#	Removed dead code.
#	Revision 1.1  2005/08/21 08:15:04Z  Pauli
#	Initial revision
#	Revision 1.2  2005/08/21 09:15:04Z  garyp
#	Re-abstracted so that the general include paths and general defines are
#	set in dcl.mak.  Enhanced so that multiple include paths are allowed in
#	the same variable.
#	Revision 1.1  2005/06/12 00:05:04Z  pauli
#	Initial revision
#	Revision 1.3  2005/06/12 00:05:04Z  PaulI
#	Added support for product and subproduct numbers.
#	Revision 1.2  2005/01/26 01:56:36Z  GaryP
#	Documentation update.
#	Revision 1.1  2005/01/16 20:41:34Z  GaryP
#	Initial revision
#----------------------------------------------------------------------------

ifndef TOOLSET_MAK_INCLUDED
TOOLSET_MAK_INCLUDED = 1

#--------------------------------------------------------------------
#	Reality	Checks
#--------------------------------------------------------------------


#--------------------------------------------------------------------
#	Basic Settings
#--------------------------------------------------------------------

# The ToolSet number must be unique for each ToolSet and must
# match	the values found in dltlset.h and dltlset.inc.

B_TOOLSETNUM=7152

B_ARESNAME=a_flags$(B_DEBUG).rsp
B_CRESNAME=c_flags$(B_DEBUG).rsp
B_ASMDEFCMD=-D#				Assembler switch to define a symbol
B_CDEFCMD=-D#				C compiler switch to define a symbol

TOOLSETINIT : ARESFILES	CRESFILES GENERIC_DEFINES GENERIC_INCLUDES LOCAL_INCLUDES


.PHONY: $(B_INCPATHS)

$(B_INCPATHS):
	@echo -I"$@"					>>$(B_ARESNAME)
	@echo -I"$@"					>>$(B_CRESNAME)

LOCAL_INCLUDES: $(B_INCPATHS)


#--------------------------------------------------------------------
#	 Assembler Settings
#--------------------------------------------------------------------

# @echo	$(B_AOPTION)			       >>$(B_ARESNAME)

ARESFILES :
	@echo -l					 >$(B_ARESNAME)
	@echo -LcDElMNPQsWX				>>$(B_ARESNAME)
	@echo -gs				        >>$(B_ARESNAME)
	@echo -il				        >>$(B_ARESNAME)


#--------------------------------------------------------------------
#	C Compiler Settings
#
#	-w068 is included to remove warnings
#	 generated by functions	that don't use
#	 all their passed parameters
#--------------------------------------------------------------------

CRESFILES :
	@echo -A1					 >$(B_CRESNAME)
	@echo -w068					>>$(B_CRESNAME)
	@echo -err					>>$(B_CRESNAME)
ifdef B_CFLAGS
	@echo $(B_CFLAGS)				>>$(B_CRESNAME)
endif
ifdef B_LOCALCFLAGS
	@echo $(B_LOCALCFLAGS)				>>$(B_CRESNAME)
endif
ifneq ($(B_DEBUG), 0)
	@echo -g					>>$(B_CRESNAME)
endif


#--------------------------------------------------------------------
#	Linker Settings
#--------------------------------------------------------------------

ifeq ($(B_DEBUG), 0)
B_LDEBUG =
else
B_LDEBUG = -V
endif

#B_LOPTION =

B_LFLAGS = -M -w8 -L"P_TOOLROOT)\$(B_TOOLLIB)" $(B_LOPTION) $(B_LDEBUG)

# If the linker	requires an appended symbol when specifying
# additional libraries on subsequent lines, define it here.

B_LIBADDCMD = +


#--------------------------------------------------------------------
#	Default	Rules for this ToolSet
#--------------------------------------------------------------------

# ".OBD" is used for DEBUG object code
# ".OBR" is used for RELEASE object code


%.obj :	%.c
	$(B_REDIR) $(B_CC) -o $*.oj -f$(B_CRESNAME) $*.c > NUL
	$(B_REDIR) $(B_ASM) -o $*.obj $*.oj > NUL
%.obd :	%.c
	$(B_REDIR) $(B_CC) -o $*.od -f$(B_CRESNAME) $*.c > NUL
	$(B_REDIR) $(B_ASM) -o $*.obd $*.od > NUL

%.obr :	%.c
	$(B_REDIR) $(B_CC) -o $*.or -f$(B_CRESNAME) $*.c > NUL
	$(B_REDIR) $(B_ASM) -o $*.obr $*.or > NUL

%.obj :	%.asm
	$(B_ASM) -f$(B_ARESNAME) $*.asm

%.obd :	%.asm
	$(B_ASM) -f$(B_ARESNAME) $*.asm, $*.obd

%.obr :	%.asm
	$(B_ASM) -f$(B_ARESNAME) $*.asm, $*.obr



endif	# TOOLSET_MAK_INCLUDED

